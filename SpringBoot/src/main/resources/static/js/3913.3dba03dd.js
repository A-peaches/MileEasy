"use strict";(self["webpackChunkmile"]=self["webpackChunkmile"]||[]).push([[3913],{3913:function(e,t,o){o.r(t),o.d(t,{default:function(){return $}});var a=o(641),n=o(33);const s=e=>((0,a.Qi)("data-v-03fea50e"),e=e(),(0,a.jt)(),e),i={class:"cards page-back mx-auto"},l={class:"bold-x-lg mt-5",style:{"font-family":"KB_C3","margin-bottom":"80px",position:"relative"}},r={class:"popover-content"},h={class:"popover-title"},p={class:"popover-table"},c=s((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"ÎßàÏùºÎ¶¨ÏßÄÎ™Ö"),(0,a.Lk)("th",null,"Í∞ÄÏ§ëÏπò")])],-1))),u={class:"date-download-container"},g={class:"table-responsive"},d=s((()=>(0,a.Lk)("div",{class:"text-start text-gray mx-auto mt-3 custom-caption",style:{width:"90%"}},[(0,a.eW)(" * Î≥∏ Îç∞Ïù¥ÌÑ∞Îäî ÏßÄÏó≠ÏòÅÏóÖÍ∑∏Î£πÎ≥Ñ Í∞ÄÏ§ëÏπòÍ∞Ä Ï†ÅÏö©Îêú Ï†êÏàòÏûÖÎãàÎã§. "),(0,a.Lk)("br"),(0,a.eW)(" * ÎßàÏùºÎ¶¨ÏßÄÎäî Í∏∞Ï§ÄÏùºÏûêÏùò ÎßàÏùºÎ¶¨ÏßÄ Ï†êÏàòÎ°ú Ï±ÖÏ†ïÎê©ÎãàÎã§. ÎßàÏùºÎ¶¨ÏßÄÎ≥Ñ ÏóÖÎç∞Ïù¥Ìä∏ ÎÇ†ÏßúÍ∞Ä ÏÉÅÏù¥Ìï† Ïàò ÏûàÏäµÎãàÎã§. ")],-1))),k={class:"table table-hover custom-table mx-auto",style:{width:"90%"}},m=s((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"ÎßàÏùºÎ¶¨ÏßÄ ÏàúÏúÑ"),(0,a.Lk)("th",null,"ÏßÅÏõêÎ≤àÌò∏"),(0,a.Lk)("th",null,"ÏßÅÏõêÎ™Ö"),(0,a.Lk)("th",null,"ÎßàÏùºÎ¶¨ÏßÄ Ìï©Í≥Ñ")])],-1))),v={class:"rank-badge"},L={key:0},P={class:"pagination-container"},_={class:"pagination"},f=["disabled"],b=["onClick"],w=["disabled"];function y(e,t,o,s,y,C){const D=(0,a.g2)("Datepicker");return(0,a.uX)(),(0,a.CE)("div",i,[(0,a.Lk)("h2",l,[(0,a.eW)((0,n.v_)(e.getLoginInfo?.group_name)+" ÎßàÏùºÎ¶¨ÏßÄ Í¥ÄÎ¶¨ ",1),(0,a.Lk)("i",{class:"bi bi-question-circle help-icon",onClick:t[0]||(t[0]=(...e)=>C.toggleHelpPopover&&C.toggleHelpPopover(...e)),style:{"font-size":"22pt"},ref:"helpIcon"},null,512),y.showHelpPopover?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"help-popover",ref:"helpPopover",style:(0,n.Tr)(y.popoverStyle)},[(0,a.Lk)("div",r,[(0,a.Lk)("h5",h,(0,n.v_)(e.getLoginInfo?.group_name)+" ÌòÑÏû¨ Í∞ÄÏ§ëÏπò",1),(0,a.Lk)("table",p,[c,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(y.groupWeight,(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.group_name},[(0,a.Lk)("td",null,(0,n.v_)(e?.mile_name),1),(0,a.Lk)("td",null,(0,n.v_)(e?.weight),1)])))),128))])])])],4)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",u,[(0,a.bF)(D,{modelValue:y.selectedDate,"onUpdate:modelValue":t[1]||(t[1]=e=>y.selectedDate=e),format:C.formatDate,class:"custom-datepicker"},null,8,["modelValue","format"]),(0,a.Lk)("i",{class:"bi bi-download download-icon",onClick:t[2]||(t[2]=(...e)=>C.downloadExcel&&C.downloadExcel(...e))})]),(0,a.Lk)("div",g,[d,(0,a.Lk)("table",k,[m,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(C.paginatedGroupList,(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.user_no,class:(0,n.C4)({"top-three":e?.user_rank<=3})},[(0,a.Lk)("td",null,[(0,a.Lk)("span",v,(0,n.v_)(e?.user_rank)+"ÏúÑ",1)]),(0,a.Lk)("td",null,(0,n.v_)(e?.user_no),1),(0,a.Lk)("td",null,[e.user_rank<=3?((0,a.uX)(),(0,a.CE)("span",L,"üëë")):(0,a.Q3)("",!0),(0,a.eW)(" "+(0,n.v_)(e?.user_name),1)]),(0,a.Lk)("td",null,[(0,a.Lk)("strong",null,(0,n.v_)(e?.total_sum)+"Ï†ê",1)])],2)))),128))])])]),(0,a.Lk)("div",P,[(0,a.Lk)("div",_,[(0,a.Lk)("button",{onClick:t[3]||(t[3]=e=>C.changePage(y.currentPage-1)),disabled:1===y.currentPage,class:"arrow-button"},"<",8,f),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(C.displayedPages,(e=>((0,a.uX)(),(0,a.CE)("button",{key:e,onClick:t=>C.changePage(e),class:(0,n.C4)({active:y.currentPage===e})},(0,n.v_)(e),11,b)))),128)),(0,a.Lk)("button",{onClick:t[4]||(t[4]=e=>C.changePage(y.currentPage+1)),disabled:y.currentPage===C.totalPages,class:"arrow-button"},">",8,w)])])])}var C=o(6652),D=o(6278),E=o(7682),x=o(3959),I={name:"GroupManagement",components:{Datepicker:C.A},data(){return{selectedDate:new Date((new Date).setDate((new Date).getDate()-1)),groupList:[],currentPage:1,itemsPerPage:15,showHelpPopover:!1,groupWeight:[],popoverStyle:{}}},computed:{...(0,D.L8)("login",["getLoginInfo"]),loginInfo(){return this.getLoginInfo},paginatedGroupList(){const e=(this.currentPage-1)*this.itemsPerPage,t=e+this.itemsPerPage;return this.groupList.slice(e,t)},totalPages(){return Math.ceil(this.groupList.length/this.itemsPerPage)},displayedPages(){const e=2;let t=Math.max(1,this.currentPage-e),o=Math.min(this.totalPages,this.currentPage+e);return o-t+1<2*e+1&&(1===t?o=Math.min(t+2*e,this.totalPages):t=Math.max(o-2*e,1)),Array.from({length:o-t+1},((e,o)=>t+o))}},methods:{formatDate(e){const t=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${o}-${a}`},async fetchData(){try{const e=await E.A.get("/group/getUsersRank",{params:{date:this.formatDate(this.selectedDate),group_no:this.getLoginInfo.group_no}});console.log(e.data,"Í∑∏Î£πÎç∞Ïù¥ÌÑ∞"),this.groupList=e.data}catch(e){console.error("Îç∞Ïù¥ÌÑ∞ Î∂àÎü¨Ïò§Í∏∞ Ïã§Ìå®:",e)}},changePage(e){e>=1&&e<=this.totalPages&&(this.currentPage=e)},downloadExcel(){const e=this.groupList.map((e=>({"ÎßàÏùºÎ¶¨ÏßÄ ÏàúÏúÑ":e.user_rank,"ÏßÅÏõêÎ≤àÌò∏":e.user_no,"ÏßÅÏõêÎ™Ö":e.user_name,"ÎßàÏùºÎ¶¨ÏßÄ Ìï©Í≥Ñ":e.total_sum,HotTip:e.HotTip,"BEST Branch":e["BEST Branch"],"BEST PG":e["BEST PG"],"Monthly Base":e["Monthly Base"],"Monthly Best":e["Monthly Best"],"Î¶¨Í∑∏ ÌÖåÏù¥Î∏î":e["Î¶¨Í∑∏ ÌÖåÏù¥Î∏î"],HRD:e.HRD,"ÏÜåÎπÑÏûê ÏßÄÏõê":e["ÏÜåÎπÑÏûê ÏßÄÏõê"]}))),t=x.Wp.json_to_sheet(e),o=x.Wp.book_new();x.Wp.book_append_sheet(o,t,"Í∑∏Î£π ÎßàÏùºÎ¶¨ÏßÄ ÌòÑÌô©"),x._h(o,`${this.getLoginInfo.group_name}_ÎßàÏùºÎ¶¨ÏßÄ_ÌòÑÌô©_${this.formatDate(this.selectedDate)}.xlsx`)},toggleHelpPopover(e){e.stopPropagation(),this.showHelpPopover=!this.showHelpPopover,this.showHelpPopover?this.$nextTick((()=>{this.positionPopover(),document.addEventListener("click",this.handleClickOutside)})):document.removeEventListener("click",this.handleClickOutside)},handleClickOutside(e){!this.$refs.helpPopover||this.$refs.helpPopover.contains(e.target)||this.$refs.helpIcon.contains(e.target)||(this.showHelpPopover=!1,document.removeEventListener("click",this.handleClickOutside))},async getWeight(){try{const e=await E.A.get("/group/getWeight",{params:{group_no:this.getLoginInfo.group_no}});this.groupWeight=e.data}catch(e){console.error("Îç∞Ïù¥ÌÑ∞ Î∂àÎü¨Ïò§Í∏∞ Ïã§Ìå®:",e)}},positionPopover(){const e=this.$refs.helpIcon,t=this.$refs.helpPopover;if(e&&t){const t=e.getBoundingClientRect(),o=window.innerWidth<=768;this.popoverStyle=o?{position:"absolute",top:`${t.height+10}px`,left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:"300px"}:{position:"absolute",top:`${t.height+10}px`,right:"25%",width:"300px"}}}},watch:{selectedDate:{handler(){this.fetchData()},immediate:!0}},mounted(){this.fetchData(),this.getWeight(),window.addEventListener("resize",this.positionPopover)},beforeUnmount(){window.removeEventListener("resize",this.positionPopover)}},W=o(6262);const H=(0,W.A)(I,[["render",y],["__scopeId","data-v-03fea50e"]]);var $=H}}]);
//# sourceMappingURL=3913.3dba03dd.js.map