"use strict";(self["webpackChunkmile"]=self["webpackChunkmile"]||[]).push([[3922],{3922:function(e,t,o){o.r(t),o.d(t,{default:function(){return O}});var i=o(641),n=o(3751),a=o(33);const s=e=>((0,i.Qi)("data-v-6278ea76"),e=e(),(0,i.jt)(),e),l={class:"app-container"},r={class:"content cards"},c={class:"header"},d={class:"button-container"},u=s((()=>(0,i.Lk)("span",{class:"arrow"},"❮",-1))),m=s((()=>(0,i.Lk)("div",{class:"actions"},[(0,i.Lk)("h1",{class:"title"},"공지사항 수정")],-1))),h={class:"form-group"},p=s((()=>(0,i.Lk)("label",{for:"title"},"제목",-1))),f=s((()=>(0,i.Lk)("label",{for:"category"},"카테고리",-1))),g={class:"drop-category"},y={class:"selected"},k={key:0,class:"dropdown-category",ref:"dropdownMenu"},_={class:"menu-items"},b=["onClick"],C=s((()=>(0,i.Lk)("div",null,[(0,i.Lk)("i",{class:"bi bi-caret-down-fill icon-right"})],-1))),L={class:"form-group content"},w=s((()=>(0,i.Lk)("label",{for:"content"},"내용",-1))),v={class:"form-group file-upload"},F=s((()=>(0,i.Lk)("label",{for:"file"},"첨부파일",-1))),N={class:"custom-file-upload"},I={key:0},A={class:"file-info"},E={key:1},U=s((()=>(0,i.Lk)("div",{class:"btn-yellow-container"},[(0,i.Lk)("button",{type:"submit",class:"btn-yellow"},"수정")],-1)));function $(e,t,o,s,$,D){return(0,i.uX)(),(0,i.CE)("div",l,[(0,i.Lk)("div",r,[(0,i.Lk)("div",c,[(0,i.Lk)("div",d,[(0,i.Lk)("button",{class:"back-button",onClick:t[0]||(t[0]=(...e)=>D.goBack&&D.goBack(...e))},[u,(0,i.eW)(" 이전 ")])])]),m,(0,i.Lk)("form",{onSubmit:t[7]||(t[7]=(0,n.D$)(((...e)=>D.submitForm&&D.submitForm(...e)),["prevent"]))},[(0,i.Lk)("div",h,[p,(0,i.bo)((0,i.Lk)("input",{type:"text",id:"title","onUpdate:modelValue":t[1]||(t[1]=e=>$.form.title=e),placeholder:"제목을 입력해주세요",class:"title-input"},null,512),[[n.Jo,$.form.title]])]),(0,i.Lk)("div",{class:"form-group",onClick:t[2]||(t[2]=(0,n.D$)(((...e)=>D.toggleCategory&&D.toggleCategory(...e)),["stop"])),ref:"categoryButton"},[f,(0,i.Lk)("div",g,[(0,i.Lk)("div",y,(0,a.v_)($.selectedCategory||"마일리지를 선택해주세요"),1)]),$.showCategory?((0,i.uX)(),(0,i.CE)("div",k,[(0,i.Lk)("div",_,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)($.mileages,(e=>((0,i.uX)(),(0,i.CE)("a",{class:"dropdown-item",key:e.mile_no,onClick:t=>D.selectCategory(e.mile_no,e.mile_name,t)},(0,a.v_)(e.mile_name)+" 마일리지 ",9,b)))),128))])],512)):(0,i.Q3)("",!0),C],512),(0,i.Lk)("div",L,[w,(0,i.bo)((0,i.Lk)("textarea",{id:"content","onUpdate:modelValue":t[3]||(t[3]=e=>$.form.content=e),placeholder:"내용을 입력해주세요"},null,512),[[n.Jo,$.form.content]])]),(0,i.Lk)("div",v,[F,(0,i.Lk)("div",N,[$.uploadedFileName?((0,i.uX)(),(0,i.CE)("div",I,[(0,i.Lk)("div",A,[(0,i.Lk)("span",null,(0,a.v_)(D.getDisplayFileName($.uploadedFileName)),1),(0,i.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>D.triggerFileInput&&D.triggerFileInput(...e)),type:"button",class:"file-modify-button"},"파일 수정")]),(0,i.Lk)("input",{type:"file",onChange:t[5]||(t[5]=(...e)=>D.handleFileUpload&&D.handleFileUpload(...e)),ref:"fileInput",style:{display:"none"}},null,544)])):((0,i.uX)(),(0,i.CE)("div",E,[(0,i.Lk)("input",{type:"file",onChange:t[6]||(t[6]=(...e)=>D.handleFileUpload&&D.handleFileUpload(...e)),ref:"fileInput"},null,544)]))])]),U],32)])])}o(4114),o(4603),o(7566),o(8721);var D=o(7682),B=o(6278),M={name:"NoticeModifyAdminView",data(){return{form:{notice_board_no:"",title:"",mile_no:"",file:null,content:""},uploadedFileName:"",displayFileName:"",originalMileNo:"",mileages:[],showCategory:!1,selectedCategory:""}},computed:{...(0,B.L8)("login",["getLoginInfo"]),decodedFileName(){if(this.uploadedFileName){const e=this.uploadedFileName.split("_",2);if(e.length>1)return decodeURIComponent(e[1])}return""}},mounted(){this.fetchNoticeDetails(),this.fetchMileages(),this.setUserInfo(),document.addEventListener("click",this.handleClickOutside)},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside)},methods:{getDisplayFileName(e){if(e){const t=e.split("_");return t.length>1?t.slice(1).join("_"):e}return""},goBack(){this.$router.go(-1)},toggleCategory(){this.showCategory=!this.showCategory},selectCategory(e,t,o){o.stopPropagation(),this.selectedCategory=t,this.form.mile_no=e,this.showCategory=!1},handleClickOutside(e){this.$refs.dropdownMenu&&!this.$refs.dropdownMenu.contains(e.target)&&this.$refs.categoryButton&&!this.$refs.categoryButton.contains(e.target)&&(this.showCategory=!1)},triggerFileInput(){const e=this.$refs.fileInput;e?e.click():console.error("fileInput reference is not available.")},async handleFileUpload(e){const t=e.target.files[0];if(!t)return;const o=new FormData;o.append("file",t);try{const e=await D.A.post("/notice/upload",o,{headers:{"Content-Type":"multipart/form-data"}});this.uploadedFileName=e.data,this.displayFileName=this.getDisplayFileName(e.data),this.form.file=t}catch(i){console.error("파일 업로드 중 오류 발생:",i),this.showAlert("파일 업로드 중 오류가 발생했습니다.","error")}},async downloadFile(){if(this.currentNotice.notice_board_file)try{const e=await(0,D.A)({url:`/notice/download/${this.currentNotice.notice_board_file}`,method:"GET",responseType:"blob"}),t=window.URL.createObjectURL(new Blob([e.data])),o=document.createElement("a");o.href=t,o.setAttribute("download",this.getFileName(this.currentNotice.notice_board_file)),document.body.appendChild(o),o.click(),document.body.removeChild(o)}catch(e){console.error("파일 다운로드 중 오류 발생:",e)}},async submitForm(){const e=new FormData;if(e.append("notice_board_no",this.form.notice_board_no),e.append("notice_board_title",this.form.title),e.append("mile_name",this.selectedCategory),e.append("notice_board_content",this.form.content),e.append("user_no",this.form.user_no),e.append("user_name",this.form.user_name),this.form.file){e.append("file",this.form.file,this.uploadedFileName);const t=this.getDisplayFileName(this.uploadedFileName);e.append("originalFileName",t)}try{const t=await D.A.post("/notice/update",e,{headers:{"Content-Type":"multipart/form-data"}});200===t.status?(this.showAlert("공지사항이 수정되었습니다.","success"),this.$router.push("/noticeListView")):this.showAlert("공지사항 수정 중 오류가 발생했습니다.","error")}catch(t){console.error("Error submitting form:",t),this.showAlert("공지사항 수정 중 오류가 발생했습니다.","error")}},setUserInfo(){const e=this.getLoginInfo;e&&(this.form.user_no=e.user_no,this.form.user_name=e.user_name)},fetchNoticeDetails(){const e=this.$route.params.id;D.A.get(`/notice/${e}`).then((e=>{const t=e.data;this.form.notice_board_no=t.notice_board_no,this.form.title=t.notice_board_title,this.form.mile_no=t.mile_no,this.originalMileNo=t.mile_no,this.selectedCategory=t.mile_name,this.form.content=t.notice_board_content,this.uploadedFileName=t.notice_board_file})).catch((e=>{console.error("Error fetching notice details:",e.response?e.response.data:e.message)}))},async fetchMileages(){try{const e=await D.A.get("/notice/mileage");this.mileages=e.data}catch(e){console.error("Error fetching mileages:",e.response?e.response.data:e.message)}},showAlert(e,t){this.$swal({title:e,icon:t,confirmButtonText:"확인",confirmButtonColor:"#4b4a4a"})}}},X=o(6262);const T=(0,X.A)(M,[["render",$],["__scopeId","data-v-6278ea76"]]);var O=T}}]);
//# sourceMappingURL=3922.c573fe6c.js.map