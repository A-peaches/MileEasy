"use strict";(self["webpackChunkmile"]=self["webpackChunkmile"]||[]).push([[7867],{87867:function(e,t,o){o.r(t),o.d(t,{default:function(){return A}});var i=o(20641),n=o(53751);const l=e=>((0,i.Qi)("data-v-642ece77"),e=e(),(0,i.jt)(),e),s={class:"app-container"},a={class:"content cards"},r={class:"header"},c={class:"button-container"},d=l((()=>(0,i.Lk)("span",{class:"arrow"},"❮",-1))),m=l((()=>(0,i.Lk)("div",{class:"actions"},[(0,i.Lk)("h1",{class:"title"},"M-Tip 가이드 작성")],-1))),u={class:"form-group"},h=l((()=>(0,i.Lk)("label",{for:"title"},"제목",-1))),p={class:"form-group content"},f=l((()=>(0,i.Lk)("label",{for:"content"},"내용",-1))),g={class:"form-group file-upload"},k=l((()=>(0,i.Lk)("label",{for:"file"},"첨부파일",-1))),w={class:"p-4"},L=l((()=>(0,i.Lk)("div",{class:"btn-yellow-container"},[(0,i.Lk)("button",{type:"submit",class:"btn-yellow"},"등록")],-1)));function b(e,t,o,l,b,y){return(0,i.uX)(),(0,i.CE)("div",s,[(0,i.Lk)("div",a,[(0,i.Lk)("div",r,[(0,i.Lk)("div",c,[(0,i.Lk)("button",{class:"back-button",onClick:t[0]||(t[0]=(...e)=>y.goBack&&y.goBack(...e))},[d,(0,i.eW)(" 이전 ")])])]),m,(0,i.Lk)("form",{onSubmit:t[4]||(t[4]=(0,n.D$)(((...e)=>y.submitForm&&y.submitForm(...e)),["prevent"]))},[(0,i.Lk)("div",u,[h,(0,i.bo)((0,i.Lk)("input",{type:"text",id:"title","onUpdate:modelValue":t[1]||(t[1]=e=>b.form.title=e),placeholder:"제목을 입력해주세요",class:"title-input"},null,512),[[n.Jo,b.form.title]])]),(0,i.Lk)("div",p,[f,(0,i.bo)((0,i.Lk)("textarea",{id:"content","onUpdate:modelValue":t[2]||(t[2]=e=>b.form.content=e),placeholder:"내용을 입력해주세요"},null,512),[[n.Jo,b.form.content]])]),(0,i.Lk)("div",g,[k,(0,i.Lk)("div",w,[(0,i.Lk)("div",null,[(0,i.Lk)("input",{type:"file",onChange:t[3]||(t[3]=(...e)=>y.handleFileUpload&&y.handleFileUpload(...e)),class:"md",style:{width:"100%","text-align":"right","padding-right":"70px"}},null,32)])])]),L],32)])])}o(44114);var y=o(37682),v=o(66278),C={name:"NoticeWriteAdminView",data(){return{form:{title:"",mile_no:"",kind:"",file:null,content:"",category:"",selectedKind:""},mileages:[],showCategory:!1,showKind:!1,uploadedFileName:null}},computed:{...(0,v.L8)("login",["getLoginInfo","getIsChecked"])},mounted(){this.fetchMileages(),document.addEventListener("click",this.handleClickOutside)},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside)},methods:{checkLoginInfo(){this.getLoginInfo&&!1!==this.getIsChecked&&!1!==this.getLoginInfo.user_is_admin||(window.location.href="/noAccess")},async handleFileUpload(e){const t=e.target.files[0];if(!t)return;const o=new FormData;o.append("files",t);try{const e=await y.A.post("/notice/mTipGuideUpload",o,{headers:{"Content-Type":"multipart/form-data"}}),[t,i]=e.data.split(",");console.log("Saved file name with UUID:",t),console.log("Original file name:",i),this.uploadedFileName=t+","+i,console.log("글쓰기 fileInfo:",this.uploadedFileName),this.displayFileName=i,this.form.file=this.uploadedFileName}catch(i){console.error("파일 업로드 중 오류 발생:",i),this.showAlert("파일 업로드 중 오류가 발생했습니다.","error")}},getDisplayFileName(e){const t=37;return!e||e.length<=t?e:"_"===e.charAt(t-1)?e.substring(t):e},async submitForm(){const e=new FormData;e.append("title",this.form.title),e.append("content",this.form.content),e.append("user_no",this.getLoginInfo.user_no),e.append("user_name",this.getLoginInfo.user_name),this.form.file&&(e.append("file",this.form.file),console.log("Form fileInfo:",this.form.file)),this.uploadedFileName&&e.append("file",this.uploadedFileName);try{const t=await y.A.post("/notice/mTipGuideWrite",e,{headers:{"Content-Type":"multipart/form-data"}});200===t.status?(this.showAlert("M-tIP 가이드가 등록되었습니다.","success"),this.$router.push("/mTipMainAdminView")):this.showAlert("M-tIP 가이드 등록 중 오류가 발생했습니다.","error")}catch(t){console.error("Error submitting form:",t),this.showAlert("M-tIP 가이드 등록 중 오류가 발생했습니다.","error")}},goBack(){this.$router.go(-1)},async fetchMileages(){try{const e=await y.A.get("/notice/mileage");this.mileages=e.data}catch(e){console.error("Error fetching mileages:",e.response?e.response.data:e.message)}},showAlert(e,t){this.$swal({title:e,icon:t,confirmButtonText:"확인",confirmButtonColor:"#4b4a4a",allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,stopKeydownPropagation:!1,scrollbarPadding:!1,backdrop:!0,didOpen:()=>{document.body.classList.add("no-scroll"),document.documentElement.style.overflow="hidden"},willClose:()=>{document.body.classList.remove("no-scroll"),document.documentElement.style.overflow="",window.scrollTo(0,scrollY)}})},handleClick(e){this.handleClickOutside(e)}},watch:{},created(){this.checkLoginInfo()}},F=o(66262);const I=(0,F.A)(C,[["render",b],["__scopeId","data-v-642ece77"]]);var A=I}}]);
//# sourceMappingURL=7867.338b2735.js.map