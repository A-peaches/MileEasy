"use strict";(self["webpackChunkmile"]=self["webpackChunkmile"]||[]).push([[6494],{6494:function(e,t,i){i.r(t),i.d(t,{default:function(){return z}});var s=i(641),o=i(3751),n=i(33);const a=e=>((0,s.Qi)("data-v-7085385d"),e=e(),(0,s.jt)(),e),c={class:"app-container"},r=a((()=>(0,s.Lk)("div",null,[(0,s.Lk)("h2",null,"Q&A")],-1))),l=a((()=>(0,s.Lk)("div",{class:"category-button list-wrapper"},"카테고리",-1))),d={key:0,class:"dropdown-menu",ref:"dropdownMenu"},h={class:"menu-items"},g=["onClick"],u={key:0},k={key:1},_={class:"notice-count-container"},m={class:"notice-count"},C={class:"checkbox-container"},y=a((()=>(0,s.Lk)("span",{class:"custom-checkbox"},null,-1))),p=a((()=>(0,s.Lk)("span",{class:"checkbox-label"},"최신순",-1))),b={key:0},v=a((()=>(0,s.Lk)("i",{class:"bi bi-pencil",style:{"margin-right":"10px"}},null,-1))),w={class:"search-container"},f=a((()=>(0,s.Lk)("i",{class:"bi bi-search"},null,-1))),L=[f],P={class:"notice-list"},D={key:0},E=["onClick"],I={class:"notice-details"},N={key:0,class:"notice-new"},B={key:1,class:"notice-num"},X={class:"notice-mile"},A={class:"notice-title"},x={class:"notice-date"},Q=a((()=>(0,s.Lk)("i",{class:"bi bi-eye"},null,-1))),V={class:"notice-views"},W=a((()=>(0,s.Lk)("i",{class:"fa fa-eye"},null,-1))),$={key:1},T=a((()=>(0,s.Lk)("p",null,"게시글이 없습니다.",-1))),M=[T],F={class:"pagination"},K=["disabled"],O=["onClick"],U=["disabled"];function j(e,t,i,a,f,T){return(0,s.uX)(),(0,s.CE)("div",c,[(0,s.Lk)("div",{class:"content cards",onClick:t[9]||(t[9]=(...t)=>e.handleClick&&e.handleClick(...t))},[r,(0,s.Lk)("div",{onClick:t[1]||(t[1]=(0,o.D$)(((...e)=>T.toggleCategory&&T.toggleCategory(...e)),["stop"])),class:"QnA",ref:"categoryButton"},[l,f.showCategory?((0,s.uX)(),(0,s.CE)("div",d,[(0,s.Lk)("div",h,[(0,s.Lk)("a",{class:"dropdown-item",onClick:t[0]||(t[0]=e=>T.filterByCategory(null))},"전체"),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(f.mileages,(e=>((0,s.uX)(),(0,s.CE)("a",{class:"dropdown-item",key:e.mile_no,onClick:t=>T.filterByCategory(e.mile_name)},["기타"===e.mile_name?((0,s.uX)(),(0,s.CE)("span",u,(0,n.v_)(e.mile_name),1)):((0,s.uX)(),(0,s.CE)("span",k,(0,n.v_)(e.mile_name)+" 마일리지",1))],8,g)))),128))])],512)):(0,s.Q3)("",!0)],512),(0,s.Lk)("div",_,[(0,s.Lk)("div",m,"총 "+(0,n.v_)(T.filteredNotices.length)+"건",1),(0,s.Lk)("label",C,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>f.sortByDateAsc=e),onChange:t[3]||(t[3]=e=>T.handleCheckboxChange("date"))},null,544),[[o.lH,f.sortByDateAsc]]),y,(0,s.eW)(),p])]),(0,s.Lk)("div",null,[T.isLoggedIn&&T.loginInfo.user_is_admin&&!T.loginInfo.user_is_manager&&T.isChecked?((0,s.uX)(),(0,s.CE)("div",b,[(0,s.Lk)("button",{class:"write-button",onClick:t[4]||(t[4]=(...e)=>T.goToWritePage&&T.goToWritePage(...e))},[v,(0,s.eW)(" 글작성 ")])])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",w,[(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=e=>f.searchQuery=e),placeholder:"제목 및 내용을 검색하세요",class:"input-search"},null,512),[[o.Jo,f.searchQuery]]),(0,s.Lk)("button",{class:"search-button",onClick:t[6]||(t[6]=(...e)=>T.searchNotices&&T.searchNotices(...e))},L)]),(0,s.Lk)("div",P,[T.paginatedNotices.length?((0,s.uX)(),(0,s.CE)("div",D,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(T.paginatedNotices,(e=>((0,s.uX)(),(0,s.CE)("div",{class:"input-base list-wrapper",key:e.notice_board_no,onClick:t=>T.handleNoticeClick(e)},[(0,s.Lk)("div",I,[e.is_new?((0,s.uX)(),(0,s.CE)("div",N,(0,n.v_)(e.display_num),1)):((0,s.uX)(),(0,s.CE)("div",B,(0,n.v_)(e.display_num),1)),(0,s.Lk)("div",X,(0,n.v_)(e.mile_name)+" 마일리지",1),(0,s.Lk)("div",A,(0,n.v_)(e.notice_board_title),1),(0,s.Lk)("div",x,(0,n.v_)(T.formatDate(e.notice_board_date)),1),Q,(0,s.Lk)("div",V,[(0,s.eW)((0,n.v_)(e.notice_board_hit)+" ",1),W])])],8,E)))),128))])):((0,s.uX)(),(0,s.CE)("div",$,M))]),(0,s.Lk)("div",F,[(0,s.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>T.prevPage&&T.prevPage(...e)),disabled:1===f.currentPage},"〈",8,K),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(T.totalPages,(e=>((0,s.uX)(),(0,s.CE)("button",{onClick:t=>T.goToPage(e),class:(0,n.C4)({active:f.currentPage===e}),key:e},(0,n.v_)(e),11,O)))),128)),(0,s.Lk)("button",{onClick:t[8]||(t[8]=(...e)=>T.nextPage&&T.nextPage(...e)),disabled:f.currentPage===T.totalPages},"〉",8,U)])])])}i(4114);var H=i(6278),J=i(7682),R={data(){return{notices:[],mileages:[],showCategory:!1,currentPage:1,itemsPerPage:10,searchQuery:"",selectedCategory:null,isProcessing:!1,sortByDateAsc:!0,sortByViews:!1}},computed:{...(0,H.L8)("login",["getLoginInfo","getIsChecked"]),filteredNotices(){let e=this.notices;if(this.searchQuery){const t=this.searchQuery.toLowerCase();e=e.filter((e=>e.notice_board_title.toLowerCase().includes(t)||e.notice_board_content.toLowerCase().includes(t)))}null!==this.selectedCategory&&(e=e.filter((e=>e.mile_name===this.selectedCategory))),this.sortByViews?e.sort(((e,t)=>t.notice_board_hit-e.notice_board_hit||new Date(t.notice_board_date)-new Date(e.notice_board_date))):this.sortByDateAsc?e.sort(((e,t)=>new Date(t.notice_board_date)-new Date(e.notice_board_date))):e.sort(((e,t)=>new Date(e.notice_board_date)-new Date(t.notice_board_date)));let t=1;return e.map((e=>({...e,is_new:this.isNew(e.notice_board_date),display_num:this.isNew(e.notice_board_date)?"NEW":t++})))},loginInfo(){return this.getLoginInfo},isChecked(){return this.getIsChecked},isLoggedIn(){return!!this.loginInfo},totalPages(){return Math.ceil(this.filteredNotices.length/this.itemsPerPage)},paginatedNotices(){const e=(this.currentPage-1)*this.itemsPerPage,t=e+this.itemsPerPage;return this.filteredNotices.slice(e,t)}},methods:{isNew(e){const t=new Date,i=new Date(e),s=t.getTime()-i.getTime(),o=s/864e5;return o<=7},handleCheckboxChange(e){"views"===e&&this.sortByViews?this.sortByDateAsc=!1:"date"===e&&this.sortByDateAsc&&(this.sortByViews=!1)},toggleCategory(){this.showCategory=!this.showCategory},closeDropdown(){this.showCategory=!1},handleClickOutside(e){this.$refs.dropdownMenu&&!this.$refs.dropdownMenu.contains(e.target)&&this.$refs.categoryButton&&!this.$refs.categoryButton.contains(e.target)&&this.closeDropdown()},goToPage(e){this.currentPage=e},nextPage(){this.currentPage<this.totalPages&&this.currentPage++},prevPage(){this.currentPage>1&&this.currentPage--},goToWritePage(){this.$router.push({name:"noticeWriteAdminView"})},async fetchNotices(){console.log("fetchNotices method called");try{const e=await J.A.get("/notice/list");console.log("Fetched notices:",e.data),this.notices=e.data}catch(e){console.error("Error fetching notices:",e.response?e.response.data:e.message)}},async fetchMileages(){try{const e=await J.A.get("/notice/mileage");console.log("Fetched mileages:",e.data),this.mileages=e.data}catch(e){console.error("Error fetching mileages:",e.response?e.response.data:e.message)}},async handleNoticeClick(e){if(!this.isProcessing){this.isProcessing=!0;try{const t=await J.A.post(`/notice/increment-views/${e.notice_board_no}`);console.log("Increment views response:",t.data);const i=this.notices.findIndex((t=>t.notice_board_no===e.notice_board_no));-1!==i&&(this.notices[i]={...this.notices[i],notice_board_hit:(this.notices[i].notice_board_hit||0)+1}),this.$router.push({name:"noticeDetailView",params:{id:e.notice_board_no,notice:{...e,mile_no:e.mile_no,mile_name:e.mile_name}}})}catch(t){console.error("Error incrementing views:",t.response?t.response.data:t.message)}finally{this.isProcessing=!1}}},formatDate(e){const t={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(e).toLocaleDateString("ko-KR",t)},searchNotices(){this.currentPage=1},filterByCategory(e){this.selectedCategory=e,this.currentPage=1},refreshPage(){this.selectedCategory=null,this.searchQuery="",this.currentPage=1}},mounted(){console.log("loginInfo:",this.loginInfo),console.log("isLoggedIn:",this.isLoggedIn),console.log("isChecked:",this.isChecked),document.addEventListener("click",this.handleClickOutside),this.fetchNotices(),this.fetchMileages()},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside)}},S=i(6262);const q=(0,S.A)(R,[["render",j],["__scopeId","data-v-7085385d"]]);var z=q}}]);
//# sourceMappingURL=6494.0574bca4.js.map