"use strict";(self["webpackChunkmile"]=self["webpackChunkmile"]||[]).push([[8240],{8240:function(t,e,a){a.r(e),a.d(e,{default:function(){return Yt}});var s=a(641),i=a(33);const o=t=>((0,s.Qi)("data-v-638a0899"),t=t(),(0,s.jt)(),t),n={class:"cards page-back mx-auto"},r=o((()=>(0,s.Lk)("h2",{class:"bold-x-lg mt-5 mb-4",style:{"font-family":"KB_C3"}},[(0,s.eW)(" 목표설정 "),(0,s.Lk)("hr",{style:{width:"13%",border:"0",height:"2px",background:"black"},class:"mx-auto"})],-1))),l={class:"input-base input-search d-flex justify-content-center mx-auto my-5",style:{width:"600px",background:"#ebebeb"}};function d(t,e,a,o,d,c){return(0,s.uX)(),(0,s.CE)("div",n,[r,(0,s.Lk)("div",l,[(0,s.Lk)("button",{class:(0,i.C4)(["tab-container lg2 fw-bold",{active:"together"===d.activeTab}]),onClick:e[0]||(e[0]=t=>c.setActiveTab("together"))}," 참여형 ",2),(0,s.Lk)("button",{class:(0,i.C4)(["tab-container lg2 fw-bold",{active:"personal"===d.activeTab}]),onClick:e[1]||(e[1]=t=>c.setActiveTab("personal"))}," 개인형 ",2)]),((0,s.uX)(),(0,s.Wv)((0,s.$y)(c.currentComponent),{onDataLoaded:t.handleDataLoaded,class:"my-5"},null,40,["onDataLoaded"]))])}a(4114);var c=a(3751);const g=t=>((0,s.Qi)("data-v-aa791790"),t=t(),(0,s.jt)(),t),p={class:"d-flex justify-content-start align-items-center mb-5",style:{"margin-left":"5%"}},u={class:"radio-container p-3 lg2 mr-3"},m={style:{display:"flex","align-items":"center"}},h={style:{"font-family":"'KB_C2'","font-size":"18px","margin-left":"-40px","margin-right":"25px","margin-bottom":"2px",color:"#333"}},f=g((()=>(0,s.Lk)("label",{class:"radio-label",for:"finished"},[(0,s.Lk)("span",{class:"custom-radio"}),(0,s.eW)(" 종료 ")],-1))),y={class:"radio-container p-3 lg2"},k=g((()=>(0,s.Lk)("label",{class:"radio-label",for:"notFinished"},[(0,s.Lk)("span",{class:"custom-radio"}),(0,s.eW)(" 참여 ")],-1))),b={class:"radio-container p-3 lg2"},L=g((()=>(0,s.Lk)("label",{class:"radio-label",for:"notjoin"},[(0,s.Lk)("span",{class:"custom-radio"}),(0,s.eW)(" 미참여 ")],-1))),v={key:0,class:"row"},x={class:"p-3"},T={class:"py-3",style:{display:"flex","align-items":"center","justify-content":"space-between","margin-bottom":"-10px"}},w={style:{display:"flex","align-items":"center",flex:"1"}},_={style:{"text-align":"left","margin-left":"10px","margin-top":"10px","font-weight":"bold","font-family":"KB_C2","font-size":"13pt"},class:"mb-2"},C={style:{display:"flex","align-items":"center","justify-content":"flex-end",width:"100px",position:"relative",overflow:"hidden"}},P={key:0,class:"participation-info"},D=["onClick"],B=g((()=>(0,s.Lk)("i",{class:"bi bi-person-vcard",style:{"margin-right":"12px","margin-bottom":"2px","font-size":"25px",color:"#8c8c8c"}},null,-1))),I={style:{"margin-right":"25px"}},E=["onClick","disabled"],S={class:"py-3",style:{display:"flex","flex-direction":"column","align-items":"flex-start","margin-left":"20px"}},M=g((()=>(0,s.Lk)("span",{class:"lg2",style:{"font-family":"'KB_C1'","font-size":"20px","margin-bottom":"-25px"}},"그룹 달성률",-1))),A=g((()=>(0,s.Lk)("br",null,null,-1))),F={style:{display:"flex","justify-content":"space-between","align-items":"center",width:"100%"}},U={class:"progress",role:"progressbar","aria-label":"Animated striped example","aria-valuenow":"60","aria-valuemin":"0","aria-valuemax":"100",style:{width:"80%","margin-right":"10px"}},X={style:{"font-weight":"bold","white-space":"nowrap","font-family":"'KB_C2'","font-size":"25px","margin-right":"10px"}},K={class:"md",style:{"margin-top":"5px","font-size":"13px","font-family":"'KB_C2'"}},j=g((()=>(0,s.Lk)("span",{class:"lg2",style:{"font-family":"'KB_C1'","font-size":"17px"}}," 🎯 나의 마일리지 / 목표 마일리지 ",-1))),V={class:"py-3"},z={class:"bold-x-lg",style:{"font-family":"'KB_C1'"}},N={class:"highlight-score"},R={key:1,style:{"font-size":"20px"}},$=g((()=>(0,s.Lk)("i",{class:"bi bi-arrow-clockwise"},null,-1)));function O(t,e,a,o,n,r){return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.Lk)("div",p,[(0,s.Lk)("div",u,[(0,s.Lk)("div",m,[(0,s.Lk)("span",h," 총 "+(0,i.v_)(r.totalTargetsCount)+"건 ",1)]),(0,s.bo)((0,s.Lk)("input",{class:"radio-input",type:"radio",name:"targetList",id:"finished",value:"finished","onUpdate:modelValue":e[0]||(e[0]=t=>n.sortBy=t)},null,512),[[c.XL,n.sortBy]]),f]),(0,s.Lk)("div",y,[(0,s.bo)((0,s.Lk)("input",{class:"radio-input",type:"radio",name:"targetList",id:"notFinished",value:"not-finished","onUpdate:modelValue":e[1]||(e[1]=t=>n.sortBy=t)},null,512),[[c.XL,n.sortBy]]),k]),(0,s.Lk)("div",b,[(0,s.bo)((0,s.Lk)("input",{class:"radio-input",type:"radio",name:"targetList",id:"notjoin",value:"notjoin","onUpdate:modelValue":e[2]||(e[2]=t=>n.sortBy=t)},null,512),[[c.XL,n.sortBy]]),L])]),n.isLoading?((0,s.uX)(),(0,s.CE)("div",R,[$,(0,s.eW)(" 로딩 중... ")])):((0,s.uX)(),(0,s.CE)("div",v,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.displayedTargets,((t,a)=>((0,s.uX)(),(0,s.CE)("div",{key:t.target_no,class:"col-md-4 mb-3"},[(0,s.Lk)("div",x,[(0,s.Lk)("div",{style:(0,i.Tr)([{backgroundColor:n.backgroundColors[a%n.backgroundColors.length]},{width:"370px",height:"320px",transition:"transform 0.3s ease","border-radius":"1px"}]),class:"mx-auto rounded-4 target-box"},[(0,s.Lk)("div",T,[(0,s.Lk)("div",w,[(0,s.Lk)("span",{class:(0,i.C4)([r.getStatusClass(t),"status-label"]),style:{"margin-left":"20px"}},(0,i.v_)(r.getStatusText(t)),3),(0,s.Lk)("div",_,(0,i.v_)(t.mile_name)+" 마일리지 ",1)]),(0,s.Lk)("div",C,[r.isUserParticipating(t.target_no)?((0,s.uX)(),(0,s.CE)("div",P,[(0,s.Lk)("div",{onClick:e=>r.handleClick(t.target_no),class:"participant-count"},[B,(0,s.Lk)("span",I,(0,i.v_)(t.participantCount),1)],8,D),r.isDropdownVisible(t.target_no)?((0,s.uX)(),(0,s.CE)("div",{key:0,class:"dropdown-menu",onClick:e[3]||(e[3]=(0,c.D$)((()=>{}),["stop"]))},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t.participants,(t=>((0,s.uX)(),(0,s.CE)("p",{key:t.user_no,style:{margin:"0",padding:"5px 0"}},(0,i.v_)(t.user_name),1)))),128))])):(0,s.Q3)("",!0)])):((0,s.uX)(),(0,s.CE)("button",{key:1,onClick:e=>r.joinTarget(t.target_no),class:"join-button",disabled:"진행중"!==r.getStatusText(t)}," 참여하기 > ",8,E))])]),(0,s.Lk)("div",S,[M,A,(0,s.Lk)("div",F,[(0,s.Lk)("div",U,[(0,s.Lk)("div",{class:"progress-bar progress-bar-striped progress-bar-animated",style:(0,i.Tr)({width:Math.min(t.achievementRate,100)+"%",backgroundColor:"#FB773C "})},null,4)]),(0,s.Lk)("span",X,(0,i.v_)(Math.min(t.achievementRate,100))+"%",1)]),(0,s.Lk)("span",K,(0,i.v_)(t.start_date)+" - "+(0,i.v_)(t.end_date),1)]),j,(0,s.Lk)("div",V,[(0,s.Lk)("span",z,[(0,s.Lk)("span",N,(0,i.v_)(t.totalMileScoreByMileNo),1),(0,s.eW)(" / "+(0,i.v_)(t.target_mileage),1)])])],4)])])))),128))]))])}var W=a(6278),Q=a(7682),J={name:"TogetherTarget",data(){return{mileages:[],backgroundColors:["#F5F5F5"],sortBy:"notjoin",isUserParticipated:{},userParticipatedTargets:JSON.parse(localStorage.getItem("userParticipatedTargets")||"[]"),isLoading:!0,dropDownVisible:{}}},methods:{...(0,W.i0)("target",["fetchAdminTargets","joinTarget","checkParticipation"]),loginInfo(){return this.getLoginInfo},isChecked(){return this.getIsChecked},isLoggedIn(){return!!this.loginInfo},async fetchMileages(){try{const t=await Q.A.get("/notice/mileage");this.mileages=t.data}catch(t){console.error("Error fetching mileages:",t.response?t.response.data:t.message)}},getStatusClass(t){const e=new Date,a=new Date(t.start_date),s=new Date(t.end_date);return e<a?"upcoming":e>s?"completed":"ongoing"},getStatusText(t){const e=new Date,a=new Date(t.start_date),s=new Date(t.end_date);return e<a?"예정":e>s?"종료":"진행중"},sortTargets(t){return t.sort(((t,e)=>{if(t.mile_no!==e.mile_no)return t.mile_no-e.mile_no;const a=this.getStatusText(t),s=this.getStatusText(e),i=this.isUserParticipating(t.target_no),o=this.isUserParticipating(e.target_no);return i&&!o?-1:!i&&o?1:"진행중"===a&&"진행중"!==s?-1:"진행중"!==a&&"진행중"===s?1:"예정"===a&&"예정"!==s?-1:"예정"!==a&&"예정"===s||"종료"===a&&"종료"!==s?1:"종료"!==a&&"종료"===s?-1:0}))},filteredTargets(t){return this.adminTargets.filter((e=>{const a=this.getStatusText(e),s=this.isUserParticipating(e.target_no);return"finished"===t?"종료"===a:"not-finished"===t?s&&"종료"!==a:"notjoin"!==t||(!s&&"진행중"===a||"예정"===a)}))},sortedAdminTargets(t){return t.sort(((t,e)=>t.mile_no-e.mile_no))},async checkParticipation(t){try{const e=await this.$store.dispatch("target/checkParticipation",{targetNo:t,userNo:this.loginInfo.user_no});if("boolean"===typeof e)return console.log(`8. Checking participation for target ${t}:`,e),this.isUserParticipated[t]=e,e;throw new Error("Invalid response format")}catch(e){return console.error("Failed to check user participation:",e),!1}},async loadUserParticipatedTargets(){try{const t=this.adminTargets.map((t=>t.target_no));console.log("5. Target numbers:",t);const e=t.map((t=>this.checkParticipation(t).then((e=>{e&&this.userParticipatedTargets.push(t)}))));await Promise.all(e),console.log("7. Updated userParticipatedTargets:",this.userParticipatedTargets)}catch(t){console.error("Failed to load user participated targets:",t)}finally{this.isLoading=!1}},async joinTarget(t){try{const e=await this.$store.dispatch("target/joinTarget",{targetNo:t,userNo:this.loginInfo.user_no});if(e.success){this.userParticipatedTargets.push(t),localStorage.setItem("userParticipatedTargets",JSON.stringify(this.userParticipatedTargets));const e=this.adminTargets.find((e=>e.target_no===t));e&&(e.participantCount=(e.participantCount||0)+1)}}catch(e){console.error("Failed to join target:",e)}},initializeUserParticipation(){this.adminTargets.forEach((t=>{this.isUserParticipated[t.target_no]=this.userParticipatedTargets.includes(t.target_no)}))},handleClick(t){console.log("Clicked:",t),this.toggleDropdown(t)},toggleDropdown(t){console.log("Clicked:",t),this.dropDownVisible[t]=!this.dropDownVisible[t]},isDropdownVisible(t){return!!this.dropDownVisible[t]},closeAllDropdowns(t){t.target.closest(".participation-info")||(this.dropDownVisible={})},isUserParticipating(t){return this.userParticipatedTargets.includes(t)},isParticipating(t){return t.participants&&t.participants.length>0}},async created(){console.log("1. Component created"),this.isLoading=!0;try{await this.fetchMileages(),await this.fetchAdminTargets(this.loginInfo.user_no),await this.loadUserParticipatedTargets()}catch(t){console.error("Error initializing component:",t)}finally{this.isLoading=!1}},mounted(){document.addEventListener("click",this.closeAllDropdowns)},beforeUnmount(){document.removeEventListener("click",this.closeAllDropdowns)},computed:{...(0,W.L8)("login",["getLoginInfo","getIsChecked"]),...(0,W.aH)("login",["loginInfo"]),...(0,W.L8)("target",["getAdminTargets"]),adminTargets(){return this.getAdminTargets},displayedTargets(){const t=this.filteredTargets(this.sortBy);return this.sortTargets(t)},totalTargetsCount(){return this.adminTargets.length}}},q=a(6262);const H=(0,q.A)(J,[["render",O],["__scopeId","data-v-aa791790"]]);var Y=H;const G=t=>((0,s.Qi)("data-v-1c271514"),t=t(),(0,s.jt)(),t),Z={class:"d-flex justify-content-start align-items-center mb-5",style:{"margin-left":"5%"}},tt={class:"radio-container p-3 lg2 mr-3"},et={style:{display:"flex","align-items":"center"}},at={style:{"font-family":"'KB_C2'","font-size":"18px","margin-left":"-40px","margin-right":"25px","margin-bottom":"2px",color:"#333"}},st=G((()=>(0,s.Lk)("label",{class:"radio-label",for:"finished"},[(0,s.Lk)("span",{class:"custom-radio"}),(0,s.eW)(" 종료 ")],-1))),it={class:"radio-container p-3 lg2"},ot=G((()=>(0,s.Lk)("label",{class:"radio-label",for:"notFinished"},[(0,s.Lk)("span",{class:"custom-radio"}),(0,s.eW)(" 진행중 ")],-1))),nt={key:0,class:"text-center mb-4",style:{color:"gray"}},rt={class:"row"},lt={class:"p-3"},dt={class:"py-1",style:{display:"flex","align-items":"center","margin-bottom":"-10px",position:"relative"}},ct={style:{"text-align":"left","margin-left":"10px","margin-top":"10px","font-weight":"bold","font-family":"KB_C2","font-size":"13pt"},class:"mb-2"},gt={class:"button-container"},pt=["onClick"],ut={class:"py-3",style:{display:"flex","flex-direction":"column","align-items":"flex-start","margin-left":"20px"}},mt=G((()=>(0,s.Lk)("span",{class:"lg2",style:{"font-family":"'KB_C1'","font-size":"20px","margin-bottom":"-25px"}},"개인 진행률",-1))),ht=G((()=>(0,s.Lk)("br",null,null,-1))),ft={style:{display:"flex","justify-content":"space-between","align-items":"center",width:"100%"}},yt={class:"progress",role:"progressbar","aria-label":"Animated striped example","aria-valuenow":"60","aria-valuemin":"0","aria-valuemax":"100",style:{width:"80%","margin-right":"10px"}},kt={style:{"font-weight":"bold","white-space":"nowrap","font-family":"'KB_C2'","font-size":"25px","margin-right":"10px"}},bt={class:"md",style:{"margin-top":"5px","font-size":"13px","font-family":"'KB_C2'"}},Lt=G((()=>(0,s.Lk)("span",{class:"lg2",style:{"font-family":"'KB_C1'","font-size":"17px"}}," 🎯 나의 마일리지 / 목표 마일리지 ",-1))),vt={class:"py-3"},xt={class:"bold-x-lg",style:{"font-family":"'KB_C1'"}},Tt={class:"highlight-score"},wt={class:"d-flex justify-content-center",style:{"margin-top":"12vh"}},_t={key:1,class:"modal-overlay"},Ct={class:"modal-content"},Pt={class:"modal-header"},Dt=G((()=>(0,s.Lk)("h2",{class:"modal-title"},"개인별 목표 설정하기",-1))),Bt={class:"modal-body"},It={class:"form-group"},Et=G((()=>(0,s.Lk)("label",{for:"mileage-select"},"목표 마일리지",-1))),St={class:"select-wrapper"},Mt=["value"],At=G((()=>(0,s.Lk)("i",{class:"bi bi-caret-down-fill select-icon"},null,-1))),Ft={class:"form-group"},Ut=G((()=>(0,s.Lk)("label",null,"목표 기간",-1))),Xt={class:"date-range"},Kt=G((()=>(0,s.Lk)("span",{class:"date-separator"},"~",-1))),jt={class:"form-group"},Vt=G((()=>(0,s.Lk)("label",{for:"mileage-score"},"목표 마일리지 점수",-1))),zt={class:"modal-footer"};function Nt(t,e,a,o,n,r){const l=(0,s.g2)("Datepicker");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.Lk)("div",Z,[(0,s.Lk)("div",tt,[(0,s.Lk)("div",et,[(0,s.Lk)("span",at," 총 "+(0,i.v_)(r.totalTargetsCount)+"건 ",1)]),(0,s.bo)((0,s.Lk)("input",{class:"radio-input",type:"radio",name:"targetList",id:"finished",value:"finished","onUpdate:modelValue":e[0]||(e[0]=t=>n.sortBy=t)},null,512),[[c.XL,n.sortBy]]),st]),(0,s.Lk)("div",it,[(0,s.bo)((0,s.Lk)("input",{class:"radio-input",type:"radio",name:"targetList",id:"notFinished",value:"not-finished","onUpdate:modelValue":e[1]||(e[1]=t=>n.sortBy=t)},null,512),[[c.XL,n.sortBy]]),ot])]),0===r.filteredMileages.length?((0,s.uX)(),(0,s.CE)("div",nt," 진행 중인 목표가 없습니다. ")):(0,s.Q3)("",!0),(0,s.Lk)("div",rt,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.filteredMileages,((t,e)=>((0,s.uX)(),(0,s.CE)("div",{key:t.target_no,class:"col-md-4 mb-3"},[(0,s.Lk)("div",lt,[(0,s.Lk)("div",{style:(0,i.Tr)([{backgroundColor:n.backgroundColors[e%n.backgroundColors.length]},{width:"370px",height:"320px",transition:"transform 0.3s ease","border-radius":"1px"}]),class:"mx-auto rounded-4 target-box"},[(0,s.Lk)("div",dt,[(0,s.Lk)("span",{class:(0,i.C4)([r.getStatusClass(t),"status-label"]),style:{"margin-left":"20px"}},(0,i.v_)(r.getStatusText(t)),3),(0,s.Lk)("div",ct,(0,i.v_)(t.mile_name)+" 마일리지 ",1),(0,s.Lk)("div",gt,[(0,s.Lk)("button",{class:"delete-button",onClick:e=>r.deleteTarget(t.target_no)}," 삭제 ",8,pt)])]),(0,s.Lk)("div",ut,[mt,ht,(0,s.Lk)("div",ft,[(0,s.Lk)("div",yt,[(0,s.Lk)("div",{class:"progress-bar progress-bar-striped progress-bar-animated",style:(0,i.Tr)({width:r.calculateProgress(t),backgroundColor:"#FB773C"})},null,4)]),(0,s.Lk)("span",kt,(0,i.v_)(r.calculateProgress(t)),1)]),(0,s.Lk)("span",bt,(0,i.v_)(t.start_date)+" - "+(0,i.v_)(t.end_date),1)]),Lt,(0,s.Lk)("div",vt,[(0,s.Lk)("span",xt,[(0,s.Lk)("span",Tt,(0,i.v_)(t.achievementRate),1),(0,s.eW)(" / "+(0,i.v_)(t.target_mileage),1)])])],4)])])))),128))]),(0,s.Lk)("div",wt,[(0,s.Lk)("button",{class:"addbtn",onClick:e[2]||(e[2]=(...t)=>r.openModal&&r.openModal(...t)),style:{width:"8vw",height:"3vw","font-size":"1.2vw","font-family":"KB_C2","background-color":"#ffca05","border-radius":"10px"}}," 목표 추가 ")]),n.isModalOpen?((0,s.uX)(),(0,s.CE)("div",_t,[(0,s.Lk)("div",Ct,[(0,s.Lk)("div",Pt,[Dt,(0,s.Lk)("button",{class:"close-button",onClick:e[3]||(e[3]=(...t)=>r.closeModal&&r.closeModal(...t))},"×")]),(0,s.Lk)("div",Bt,[(0,s.Lk)("div",It,[Et,(0,s.Lk)("div",St,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>n.selectedLabel=t),id:"mileage-select",class:"form-select"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.labels,(t=>((0,s.uX)(),(0,s.CE)("option",{key:t,value:t},(0,i.v_)(t.mile_name),9,Mt)))),128))],512),[[c.u1,n.selectedLabel]]),At])]),(0,s.Lk)("div",Ft,[Ut,(0,s.Lk)("div",Xt,[(0,s.bF)(l,{modelValue:n.startDate,"onUpdate:modelValue":e[5]||(e[5]=t=>n.startDate=t),format:r.formatDate,placeholder:"시작일"},null,8,["modelValue","format"]),Kt,(0,s.bF)(l,{modelValue:n.endDate,"onUpdate:modelValue":e[6]||(e[6]=t=>n.endDate=t),format:r.formatDate,placeholder:"종료일"},null,8,["modelValue","format"])])]),(0,s.Lk)("div",jt,[Vt,(0,s.bo)((0,s.Lk)("input",{type:"number",id:"mileage-score","onUpdate:modelValue":e[7]||(e[7]=t=>n.targetScore=t)},null,512),[[c.Jo,n.targetScore]])])]),(0,s.Lk)("div",zt,[(0,s.Lk)("button",{class:"submit-button",onClick:e[8]||(e[8]=(...t)=>r.addAction&&r.addAction(...t))},"등록")])])])):(0,s.Q3)("",!0)])}var Rt=a(6652),$t=a(8465),Ot=a.n($t),Wt={name:"PersonalTarget",emits:["dataLoaded"],components:{Datepicker:Rt.A},data(){return{mileages:[],isModalOpen:!1,labels:[],selectedLabel:null,startDate:null,endDate:null,targetScore:0,backgroundColors:["#F5F5F5"],sortBy:"not-finished"}},methods:{...(0,W.i0)("target",["addPersonalTarget","fetchPersonalTargets","deleteTarget"]),loginInfo(){return this.getLoginInfo},isChecked(){return this.getIsChecked},isLoggedIn(){return!!this.loginInfo},async fetchMileages(){try{const t=await Q.A.get("/notice/mileage");console.log("fetchMileages 메소드 :",t.data),this.labels=t.data}catch(t){console.error("Error fetching mileages:",t.response?t.response.data:t.message)}},handleCheckboxChange(t){"finished"===t&&this.sortByFin?this.sortByNotFin=!1:"not-finished"===t&&this.sortByNotFin&&(this.sortByFin=!1)},formatDate(t){const e=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0");return`${e}-${a}-${s}`},openModal(){this.isModalOpen=!0},closeModal(){this.isModalOpen=!1},async addAction(){const t={mile_no:this.selectedLabel.mile_no,user_no:this.loginInfo.user_no,start_date:this.startDate,end_date:this.endDate,target_mileage:this.targetScore,is_together:!1,is_manager_plan:!1,month:(new Date).getMonth()+1,achievementRate:0};console.log("target이 서버로 데이터 넘기는 것 :",t);try{await this.addPersonalTarget(t),this.closeModal(),window.location.reload()}catch(e){console.error("Error adding target:",e.response?e.response.data:e.message)}},calculateProgress(t){if(!t.target_mileage||0===t.target_mileage)return"0%";if("예정"===this.getStatusText(t))return"0%";const e=t.achievementRate/t.target_mileage*100;return e>100?"100%":Math.round(e)+"%"},getStatusClass(t){const e=new Date,a=new Date(t.start_date),s=new Date(t.end_date);return e<a?"upcoming":e>s?"completed":"ongoing"},getStatusText(t){const e=new Date,a=new Date(t.start_date),s=new Date(t.end_date);return e<a?"예정":e>s?"종료":"진행중"},sortTargets(t){return t.sort(((t,e)=>{const a=this.getStatusText(t),s=this.getStatusText(e);return"진행중"===a&&"진행중"!==s?-1:"진행중"!==a&&"진행중"===s?1:"예정"===a&&"예정"!==s?-1:"예정"!==a&&"예정"===s?1:0}))},filteredTargets(t){const e=new Date;return this.adminTargets.filter((a=>{const s=new Date(a.end_date);return"finished"===t?e>s:e<=s}))},sortedAdminTargets(t){return t.sort(((t,e)=>t.mile_no-e.mile_no))},async loadUserParticipatedTargets(){try{const t=this.adminTargets.map((t=>t.target_no));console.log("5. Target numbers:",t);for(const e of t){const t=await this.checkParticipation(e);t&&this.userParticipatedTargets.push(e)}console.log("7. Updated userParticipatedTargets:",this.userParticipatedTargets)}catch(t){console.error("Failed to load user participated targets:",t)}finally{this.isLoading=!1}},async deleteTarget(t){Ot().fire({title:"경고",text:"정말로 삭제하시겠습니까?",icon:"warning",showCancelButton:!0,scrollbarPadding:!1,confirmButtonText:"확인",cancelButtonText:"취소",reverseButtons:!1,willOpen:()=>{document.body.style.paddingRight="0px"},willClose:()=>{document.body.style.paddingRight="0px"}}).then((async e=>{if(e.isConfirmed)try{const e=this.$store.getters["login/getLoginInfo"].user_no;await this.$store.dispatch("target/deleteTarget",{userNo:e,targetNo:t}),Ot().fire({title:"삭제 완료",text:"삭제가 완료되었습니다.",icon:"success",scrollbarPadding:!1,willOpen:()=>{document.body.style.paddingRight="0px"},willClose:()=>{document.body.style.paddingRight="0px"}})}catch(a){console.error("Error deleting target:",a),Ot().fire({title:"오류 발생",text:"삭제 중 오류가 발생했습니다. 다시 시도해 주세요.",icon:"error",scrollbarPadding:!1,willOpen:()=>{document.body.style.paddingRight="0px"},willClose:()=>{document.body.style.paddingRight="0px"}})}else Ot().fire({title:"취소됨",text:"삭제가 취소되었습니다.",icon:"info",scrollbarPadding:!1,willOpen:()=>{document.body.style.paddingRight="0px"},willClose:()=>{document.body.style.paddingRight="0px"}})}))},showAlert(t,e){this.$swal({title:t,icon:e,confirmButtonText:"확인",confirmButtonColor:"#4b4a4a",allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,stopKeydownPropagation:!1,scrollbarPadding:!1,backdrop:!0,didOpen:()=>{document.body.classList.add("no-scroll"),document.documentElement.style.overflow="hidden"},willClose:()=>{document.body.classList.remove("no-scroll"),document.documentElement.style.overflow=""}})}},async created(){console.log("targer loginInfo 이 찍히나요 ?:",this.loginInfo),console.log("isLoggedIn:",this.isLoggedIn),console.log("isChecked:",this.isChecked),this.isLoading=!0;try{await this.fetchMileages(),await this.fetchPersonalTargets(this.loginInfo.user_no).then((()=>{console.log("Targets after fetch:",this.getPersonalTargets)}))}catch(t){console.error("Error initializing component:",t)}finally{this.isLoading=!1}},computed:{...(0,W.L8)("login",["getLoginInfo","getIsChecked"]),...(0,W.aH)("login",["loginInfo"]),...(0,W.L8)("target",["getPersonalTargets"]),adminTargets(){return this.getPersonalTargets||[]},displayedTargets(){const t=this.filteredTargets(this.sortBy),e=this.sortedAdminTargets(t);return"not-finished"===this.sortBy?this.sortTargets(e):e},totalTargetsCount(){return this.displayedTargets.length},targets(){const t=this.getPersonalTargets;return console.log("Targets:",t),Array.isArray(t)?t:[]},filteredMileages(){const t=new Date,e=[...this.targets].sort(((t,e)=>t.mile_no-e.mile_no)).sort(((t,e)=>{const a=this.getStatusText(t),s=this.getStatusText(e);return"진행중"===a&&"진행중"!==s?-1:"진행중"!==a&&"진행중"===s?1:"예정"===a&&"예정"!==s?-1:"예정"!==a&&"예정"===s?1:0}));return e.filter((e=>{if(!e||!e.end_date)return console.warn("Skipping mileage due to missing endDate:",e),!1;const a=new Date(e.end_date);return isNaN(a.getTime())?(console.warn("Invalid date format in endDate:",e.end_date),!1):"finished"===this.sortBy?a<t:"not-finished"!==this.sortBy||a>=t}))}}};const Qt=(0,q.A)(Wt,[["render",Nt],["__scopeId","data-v-1c271514"]]);var Jt=Qt,qt={name:"MyMileageTarget",components:{TogetherTarget:Y,PersonalTarget:Jt},data(){return{activeTab:"together"}},methods:{setActiveTab(t){this.activeTab=t,this.$router.push({query:{tab:t}})}},created(){},computed:{currentComponent(){switch(this.activeTab){case"together":return"TogetherTarget";case"personal":return"PersonalTarget";default:return"TogetherTarget"}}},watch:{"$route.query.tab":{immediate:!0,handler(t){t&&(this.activeTab=t)}}}};const Ht=(0,q.A)(qt,[["render",d],["__scopeId","data-v-638a0899"]]);var Yt=Ht}}]);
//# sourceMappingURL=8240.a636b23f.js.map