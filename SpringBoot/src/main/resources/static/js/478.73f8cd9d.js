"use strict";(self["webpackChunkmile"]=self["webpackChunkmile"]||[]).push([[478],{478:function(t,e,a){a.r(e),a.d(e,{default:function(){return Z}});var s=a(641),l=a(33),r=a(3751);const o=t=>((0,s.Qi)("data-v-73a71c2a"),t=t(),(0,s.jt)(),t),n={class:"cards page-back mx-auto"},i=o((()=>(0,s.Lk)("h2",{class:"bold-x-lg my-5",style:{"font-family":"KB_C3"}},"목표 설정",-1))),d={class:"d-flex justify-content-end mr-5"},c={class:"mileage-goals-container"},g=o((()=>(0,s.Lk)("h3",{class:"mileage-goals-title"},"현재 진행중인 마일리지 목표",-1))),u={key:0,class:"goals-list"},m={class:"goal-info"},f={class:"goal-date"},h={class:"goal-mileage"},p={class:"goal-rate"},k={class:"progress-container"},v={key:1,class:"no-goals"},L=o((()=>(0,s.Lk)("p",{class:"lg2"},"현재 진행중인 목표가 없습니다.",-1))),_=[L],D={style:{width:"90%"},class:"mx-auto mt-5"},y=o((()=>(0,s.Lk)("h3",{class:"lg p-3 ml-5",style:{"text-align":"left","font-family":"'KB_S4'","font-size":"18pt"}},"예정된 마일리지 목표 내역",-1))),w={class:"d-flex justify-content-between"},b={class:"d-flex justify-content-evenly pr-3 pl-3 future-wrapper"},T={class:"target-list"},M={class:"target-list"},C={class:"delete-wrapper"},I=["onClick"],x={style:{width:"90%"},class:"mx-auto mt-5"},A=o((()=>(0,s.Lk)("h3",{class:"lg p-3 ml-5",style:{"text-align":"left","font-family":"'KB_S4'","font-size":"18pt"}},"지난 마일리지 목표 내역",-1))),E={class:"d-flex justify-content-between pr-3 pl-3"},S={class:"target-list"},X={class:"target-list"},V={class:"target-list"},F={key:0,class:"modal-overlay"},H={class:"modal-content"},K={class:"modal-header"},j={class:"modal-title"},R={class:"modal-body"},$={class:"form-group"},O=o((()=>(0,s.Lk)("label",null,"목표 기간",-1))),B={class:"date-range"},U=o((()=>(0,s.Lk)("span",{class:"date-separator"},"~",-1))),z={class:"form-group"},Q=o((()=>(0,s.Lk)("label",{for:"mileage-score"},"목표 마일리지 점수",-1))),J={class:"modal-footer"};function P(t,e,a,o,L,P){const Y=(0,s.g2)("Datepicker");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",n,[i,(0,s.Lk)("div",d,[(0,s.Lk)("button",{class:"btn-green target-btn",onClick:e[0]||(e[0]=(...t)=>P.openModal&&P.openModal(...t))},"목표 등록하기")]),(0,s.Lk)("div",c,[g,P.currentTargets.length>0?((0,s.uX)(),(0,s.CE)("div",u,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(P.currentTargets,((t,e)=>((0,s.uX)(),(0,s.CE)("div",{key:e,class:"goal-card"},[(0,s.Lk)("div",m,[(0,s.Lk)("span",f,"📅 "+(0,l.v_)(t.start_date)+" ~ "+(0,l.v_)(t.end_date),1),(0,s.Lk)("span",h,"🎯 "+(0,l.v_)(t.target_mileage)+" 마일리지 목표",1),(0,s.Lk)("span",p,"✨ "+(0,l.v_)(t.targetRate)+"% 달성",1)]),(0,s.Lk)("div",k,[(0,s.Lk)("div",{class:"progress-bar",style:(0,l.Tr)({width:t.targetRate+"%"})},null,4)])])))),128))])):((0,s.uX)(),(0,s.CE)("div",v,_))]),(0,s.Lk)("div",D,[y,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(P.futureTargets,(t=>((0,s.uX)(),(0,s.CE)("div",{key:t.target_no,class:"cards card-red mx-auto m-3 pointer",style:{width:"90%",height:"6vh"}},[(0,s.Lk)("div",w,[(0,s.Lk)("div",b,[(0,s.Lk)("span",T,"목표기간: "+(0,l.v_)(t.start_date)+" ~ "+(0,l.v_)(t.end_date),1),(0,s.Lk)("span",M,"목표 마일리지: "+(0,l.v_)(t.target_mileage),1)]),(0,s.Lk)("div",C,[(0,s.Lk)("button",{class:"delete-btn",onClick:e=>P.deleteTarget(t.target_no)},"삭제",8,I)])])])))),128))]),(0,s.Lk)("div",x,[A,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(P.pastTargets,(t=>((0,s.uX)(),(0,s.CE)("div",{key:t.target_no,class:"cards card-gray mx-auto m-3 pointer",style:{width:"90%",height:"6vh"}},[(0,s.Lk)("div",E,[(0,s.Lk)("span",S,"목표기간: "+(0,l.v_)(t.start_date)+" ~ "+(0,l.v_)(t.end_date),1),(0,s.Lk)("span",X,"목표 마일리지: "+(0,l.v_)(t.target_mileage),1),(0,s.Lk)("span",V,"달성률: "+(0,l.v_)(t.targetRate)+"%",1)])])))),128))])]),L.isModalOpen?((0,s.uX)(),(0,s.CE)("div",F,[(0,s.Lk)("div",H,[(0,s.Lk)("div",K,[(0,s.Lk)("h2",j,(0,l.v_)(L.mile_name)+" 목표 등록하기",1),(0,s.Lk)("button",{class:"close-button",onClick:e[1]||(e[1]=(...t)=>P.closeModal&&P.closeModal(...t))},"×")]),(0,s.Lk)("div",R,[(0,s.Lk)("div",$,[O,(0,s.Lk)("div",B,[(0,s.bF)(Y,{modelValue:L.startDate,"onUpdate:modelValue":e[2]||(e[2]=t=>L.startDate=t),format:P.formatDate,placeholder:"시작일"},null,8,["modelValue","format"]),U,(0,s.bF)(Y,{modelValue:L.endDate,"onUpdate:modelValue":e[3]||(e[3]=t=>L.endDate=t),format:P.formatDate,placeholder:"종료일"},null,8,["modelValue","format"])])]),(0,s.Lk)("div",z,[Q,(0,s.bo)((0,s.Lk)("input",{type:"number",id:"mileage-score","onUpdate:modelValue":e[4]||(e[4]=t=>L.targetScore=t)},null,512),[[r.Jo,L.targetScore]])])]),(0,s.Lk)("div",J,[(0,s.Lk)("button",{class:"submit-button",onClick:e[5]||(e[5]=(...t)=>P.addAction&&P.addAction(...t))},"등록")])])])):(0,s.Q3)("",!0)],64)}a(4114);var Y=a(6278),q=a(6652),G={name:"TargetMileageAdminView",components:{Datepicker:q.A},data(){return{isModalOpen:!1,startDate:null,endDate:null,targetScore:0,mile_name:""}},computed:{...(0,Y.L8)("mile",["getMileInfo","getArrayMiles"]),...(0,Y.L8)("login",["getLoginInfo"]),...(0,Y.L8)("mileage",["getTargets"]),targets(){return this.getTargets||[]},loginInfo(){return this.getLoginInfo},mileInfo(){return this.getMileInfo},formattedTargets(){return this.targets?this.targets.map((t=>{const e=new Date(t.start_date),a=new Date(t.end_date);return{...t,targetRate:t.achievementRate,startDate:e,endDate:a}})):[]},currentTargets(){const t=new Date;return t.setHours(0,0,0,0),this.formattedTargets.filter((e=>e.startDate.setHours(0,0,0,0)<=t&&t<=e.endDate.setHours(0,0,0,0))).sort(((t,e)=>new Date(t.startDate)-new Date(e.startDate)))},pastTargets(){const t=new Date;return t.setHours(0,0,0,0),this.formattedTargets.filter((e=>e.endDate.setHours(0,0,0,0)<t))},futureTargets(){const t=new Date;return t.setHours(0,0,0,0),this.formattedTargets.filter((e=>e.startDate.setHours(0,0,0,0)>t)).sort(((t,e)=>new Date(t.startDate)-new Date(e.startDate)))}},methods:{...(0,Y.i0)("mile",["fetchMileInfo"]),...(0,Y.i0)("mileage",["addTarget","fetchMileTarget","targetDelete"]),async addAction(){const t={mile_no:this.loginInfo.mile_no,user_no:this.loginInfo.user_no,start_date:this.formatDate(this.startDate),end_date:this.formatDate(this.endDate),target_mileage:this.targetScore},e=await this.addTarget(t);e&&e.data.success?this.showAlert("목표가 등록되었습니다","success","#"):this.showAlert("목표 등록에 실패했습니다","fail","#")},openModal(){this.isModalOpen=!0},closeModal(){this.isModalOpen=!1},showAlert(t,e,a){this.$swal({title:t,icon:e,scrollbarPadding:!1}).then((t=>{t.isConfirmed&&("#"==a?location.reload():this.$router.push(a))}))},async deleteTarget(t){const e=await this.targetDelete(t);e&&e.data.success?this.showAlert("목표가 삭제되었습니다","success","#"):this.showAlert("목표 삭제에 실패했습니다","fail","#")},formatDate(t){const e=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0");return`${e}-${a}-${s}`}},async created(){const t=this.loginInfo?this.loginInfo.user_no:null;if(t){await this.fetchMileInfo(t);const e=this.getMileInfo;e?this.mile_name=e.mile_no:console.error("마일리지 이름을 가져올 수 없습니다.")}else console.error("user_no이 유효하지 않습니다.");const e=this.loginInfo?this.loginInfo.mile_no:null;if(e)try{await this.fetchMileTarget(e)}catch(a){console.error("마일리지 목표 리스트를 가져오는 중 오류 발생:",a)}else console.error("mile_no가 유효하지 않습니다.")}},N=a(6262);const W=(0,N.A)(G,[["render",P],["__scopeId","data-v-73a71c2a"]]);var Z=W}}]);
//# sourceMappingURL=478.73f8cd9d.js.map