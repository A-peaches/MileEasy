"use strict";(self["webpackChunkmile"]=self["webpackChunkmile"]||[]).push([[1270],{1270:function(t,a,e){e.r(a),e.d(a,{default:function(){return Kt}});var s=e(641),i=e(33);const n=t=>((0,s.Qi)("data-v-47b2c606"),t=t(),(0,s.jt)(),t),o={class:"flex",style:{"margin-left":"10%","margin-right":"10%"}},r={class:"left-container"},l={key:"profile",class:"cards fade-up-item profile-card"},d=["src"],c={class:"lg KB_S4 my-3"},h={class:"md",style:{"margin-bottom":"0px"}},g={class:"md mb-2",style:{"margin-bottom":"0px"}},p=n((()=>(0,s.Lk)("button",{class:"btn-yellow KB_C2 my-3",disabled:""},"운영 관리자",-1))),u=(0,s.Fv)('<div class="cards fade-up-item menu-card" data-v-47b2c606><div style="padding:3% 0%;" data-v-47b2c606><a href="/kingTopAdminView" class="mileage-link" data-v-47b2c606><p class="lg2 link-text" style="text-align:left;" data-v-47b2c606> 마왕관리 <i class="bi bi-chevron-compact-right icon-right" style="margin-left:auto;" data-v-47b2c606></i></p></a><a href="/mileageAddAdminView" class="mileage-link" data-v-47b2c606><p class="lg2 link-text" style="text-align:left;" data-v-47b2c606> 마일리지 관리 <i class="bi bi-chevron-compact-right icon-right" style="margin-left:auto;" data-v-47b2c606></i></p></a><a href="/m_TipMainAdminView" class="mileage-link" data-v-47b2c606><p class="lg2 link-text" style="text-align:left;" data-v-47b2c606> M-TIP <i class="bi bi-chevron-compact-right icon-right" style="margin-left:auto;" data-v-47b2c606></i></p></a><a href="/noticeListView" class="mileage-link" data-v-47b2c606><p class="lg2 link-text" style="text-align:left;" data-v-47b2c606> 공지사항 <i class="bi bi-chevron-compact-right icon-right" style="margin-left:auto;" data-v-47b2c606></i></p></a><a href="/mileEasyContactView" class="mileage-link" data-v-47b2c606><p class="lg2 link-text" style="text-align:left;" data-v-47b2c606> 업무별 연락처 <i class="bi bi-chevron-compact-right icon-right" style="margin-left:auto;" data-v-47b2c606></i></p></a></div></div>',1),m={class:"right-container"};function f(t,a,e,n,f,y){const b=(0,s.g2)("PageCount"),k=(0,s.g2)("MileagePageCount"),v=(0,s.g2)("PositionChart");return(0,s.uX)(),(0,s.CE)("div",o,[(0,s.Lk)("div",r,[(0,s.Lk)("div",l,[y.loginInfo&&y.loginInfo.user_no?((0,s.uX)(),(0,s.CE)("img",{key:0,src:y.profileImageUrl,class:"profile-large my-3",alt:"Profile Picture",onError:a[0]||(a[0]=(...t)=>y.setDefaultImage&&y.setDefaultImage(...t))},null,40,d)):(0,s.Q3)("",!0),(0,s.Lk)("h2",c,(0,i.v_)(y.loginInfo?y.loginInfo.user_name:""),1),(0,s.Lk)("p",h,(0,i.v_)(y.loginInfo?`${y.loginInfo.level_no||""} ${y.loginInfo.position_no||""} | ${y.loginInfo.job_no||""} 직무`:""),1),(0,s.Lk)("p",g,(0,i.v_)(y.loginInfo?`${y.loginInfo.dp_no}`:""),1),p]),u]),(0,s.Lk)("div",m,[(0,s.bF)(b,{class:"fade-up-item"}),(0,s.bF)(k,{class:"fade-up-item",style:{"margin-top":"5%"}}),(0,s.bF)(v,{class:"fade-up-item",style:{"margin-top":"5%"}})])])}var y=e(6278),b=e(5093),k=e.n(b),v=e(8465),L=e.n(v),C=e(3751);const w=t=>((0,s.Qi)("data-v-08f58799"),t=t(),(0,s.jt)(),t),D={class:"cards",style:{"background-color":"#f9f9f9",height:"420px"}},x={class:"text-left lg2 KB_C2 ml-2"},_={class:"cards",style:{height:"330px"}},I={class:"date-container"},E={class:"dateround"},A={class:"content-container mr-5"},S={class:"chartBox ml-3"},M=["id"],P={class:"stats-container"},B={class:"stat-row",style:{"margin-top":"25px"}},$={class:"stat-item"},F=w((()=>(0,s.Lk)("i",{class:"bi bi-display"},null,-1))),T=w((()=>(0,s.Lk)("span",{class:"stat-label"},"총 방문자 수",-1))),W={class:"stat-value"},V={class:"stat-item"},z=w((()=>(0,s.Lk)("i",{class:"bi bi-reception-4"},null,-1))),O=w((()=>(0,s.Lk)("span",{class:"stat-label"},"최고 방문자 수",-1))),X={class:"stat-value"},j={class:"stat-item"},R=w((()=>(0,s.Lk)("i",{class:"bi bi-reception-2"},null,-1))),U=w((()=>(0,s.Lk)("span",{class:"stat-label"},"최소 방문자 수",-1))),K={class:"stat-value"},Q=w((()=>(0,s.Lk)("div",{class:"text-end w-100 mt-5"},[(0,s.Lk)("span",{style:{position:"absolute",top:"87%",right:"-50px",transform:"translateX(-50%)","z-index":"0","font-size":"10pt",color:"gray"}},"( 최대 조회 가능일 : 전영업일 )")],-1)));function J(t,a,e,n,o,r){return(0,s.uX)(),(0,s.CE)("div",D,[(0,s.Lk)("p",x,[(0,s.eW)("페이지 방문자 수   "),(0,s.Lk)("i",{class:"bi bi-download",onClick:a[0]||(a[0]=(...t)=>r.downloadChart&&r.downloadChart(...t))})]),(0,s.Lk)("div",_,[(0,s.Lk)("div",I,[(0,s.Lk)("div",E,[(0,s.bo)((0,s.Lk)("input",{type:"date",class:"date",id:"startDate","onUpdate:modelValue":a[1]||(a[1]=t=>o.startDate=t),onChange:a[2]||(a[2]=(...t)=>r.updateCharts&&r.updateCharts(...t))},null,544),[[C.Jo,o.startDate]]),(0,s.eW)(" - "),(0,s.bo)((0,s.Lk)("input",{type:"date",class:"date",id:"endDate","onUpdate:modelValue":a[3]||(a[3]=t=>o.endDate=t),onChange:a[4]||(a[4]=(...t)=>r.updateCharts&&r.updateCharts(...t))},null,544),[[C.Jo,o.endDate]])])]),(0,s.Lk)("div",A,[(0,s.Lk)("div",S,[(0,s.Lk)("canvas",{id:o.chartIds[0],style:{height:"280px",width:"450px"}},null,8,M)]),(0,s.Lk)("div",P,[(0,s.Lk)("div",B,[(0,s.Lk)("div",$,[F,T,(0,s.Lk)("div",W,(0,i.v_)(o.total),1)]),(0,s.Lk)("div",V,[z,O,(0,s.Lk)("div",X,(0,i.v_)(o.maxcount),1)]),(0,s.Lk)("div",j,[R,U,(0,s.Lk)("div",K,(0,i.v_)(o.mincount),1)])])])])]),Q])}e(4114);var H=e(6118),q=e(7682),Z=e(3959);H.t1.register(...H.$L);var G={name:"PageCount",data(){return{startDate:"",endDate:"",total:0,maxcount:0,mincount:0,charts:{},chartIds:["Chart1"]}},mounted(){this.setDefaultDates(),this.updateCharts()},computed:{...(0,y.L8)("login",["getLoginInfo"]),...(0,y.i0)("loginHistory",["loginHistoryCountArray"]),loginInfo(){return this.getLoginInfo}},methods:{async downloadChart(){try{const t=await this.chartDataCount(),a=this.weekDays(),e=[["날짜","방문자 수"]];a.forEach(((a,s)=>{e.push([a,t[s]||0])}));const s=Z.Wp.aoa_to_sheet(e),i=Z.Wp.book_new();Z.Wp.book_append_sheet(i,s,"Data"),Z._h(i,"chart_data.xlsx")}catch(t){console.error("Error downloading chart data:",t),L().fire({icon:"error",title:"Error",text:"차트 데이터 다운로드 중 오류가 발생했습니다."})}},setDefaultDates(){const t=new Date,a=new Date(t);a.setDate(t.getDate()-1);const e=a.toISOString().split("T")[0];t.setDate(t.getDate()-7);const s=t.toISOString().split("T")[0];this.startDate=s,this.endDate=e;const i=document.getElementById("endDate");i.setAttribute("max",e)},async updateCharts(){if(new Date(this.startDate)>new Date(this.endDate))L().fire({icon:"error",title:"Error",text:"시작 날짜는 종료 날짜보다 이전이어야 합니다."});else try{const t=await this.chartDataCount();this.total=t.reduce(((t,a)=>t+a),0),this.maxcount=Math.max(...t),this.mincount=Math.min(...t),this.renderCharts(t)}catch(t){console.error("Error fetching login history:",t)}},async chartDataCount(){const t=this.startDate.trim(),a=this.endDate.trim();try{const e=await q.A.post("/user/loginHistoryCountArray",null,{params:{startDate:t,endDate:a}});console.log("Response data:",e.data);const s=e.data.map((t=>t.count));return console.log("결과:",s),s}catch(e){return console.error("Error fetching login history:",e),[]}},renderCharts(t){this.chartIds.forEach((a=>{const e=document.getElementById(a),s=document.getElementById(a)?.getContext("2d");if(!s)return void console.error(`Canvas element with id '${a}' not found.`);this.charts[a]&&this.charts[a].destroy();const i=window.devicePixelRatio||1;e.style.width="450px",e.style.height="280px",this.charts[a]=new H.t1(s,{type:"line",data:{labels:this.weekDays(),datasets:[{label:"visit count",borderColor:"#FFCC00",data:t,tension:.3,borderRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,devicePixelRatio:i,plugins:{legend:{display:!0},title:{display:!1}},scales:{y:{ticks:{display:!0},grid:{display:!0}},x:{grid:{display:!1}}}}})}))},weekDays(){const t=[],a=new Date(this.startDate),e=new Date(this.endDate);for(let s=new Date(a);s<=e;s.setDate(s.getDate()+1)){const a=s.getMonth()+1,e=s.getDate();t.push(`${a}.${e}`)}return t}}},N=e(6262);const Y=(0,N.A)(G,[["render",J],["__scopeId","data-v-08f58799"]]);var tt=Y;const at=t=>((0,s.Qi)("data-v-cb0355e2"),t=t(),(0,s.jt)(),t),et={class:"cards",style:{"background-color":"#f9f9f9",height:"430px"}},st={class:"text-left lg2 KB_C2"},it={class:"cards favorite-card",style:{height:"335px"}},nt={class:"text-right"},ot=["max"],rt=at((()=>(0,s.Lk)("br",null,null,-1))),lt={class:"sub"},dt={class:"chart-container"},ct=["id"],ht={class:"best"},gt={class:"best-info"},pt={class:"lg2 best-title"},ut=at((()=>(0,s.Lk)("i",{class:"bi bi-hand-thumbs-up-fill",style:{"font-size":"22pt"}},null,-1))),mt={class:"lg best-name",style:{"font-size":"17pt"}},ft=at((()=>(0,s.Lk)("br",null,null,-1))),yt=at((()=>(0,s.Lk)("i",{class:"bi bi-hand-thumbs-down-fill",style:{"font-size":"22pt"}},null,-1))),bt={class:"lg best-name",style:{"font-size":"17pt"}},kt=at((()=>(0,s.Lk)("div",{class:"text-end w-100 mt-5"},[(0,s.Lk)("span",{style:{position:"absolute",top:"87%",right:"-50px",transform:"translateX(-50%)","z-index":"0","font-size":"10pt",color:"gray"}},"( 최대 조회 가능일 : 전영업일 )")],-1)));function vt(t,a,e,n,o,r){return(0,s.uX)(),(0,s.CE)("div",et,[(0,s.Lk)("div",null,[(0,s.Lk)("p",st,[(0,s.eW)("마일리지 방문자 수   "),(0,s.Lk)("i",{class:"bi bi-download",onClick:a[0]||(a[0]=(...t)=>r.downloadChart&&r.downloadChart(...t))})]),(0,s.Lk)("div",it,[(0,s.Lk)("div",nt,[(0,s.bo)((0,s.Lk)("input",{type:"date",class:"date",id:"date","onUpdate:modelValue":a[1]||(a[1]=t=>o.date=t),max:r.maxDate,onChange:a[2]||(a[2]=(...t)=>r.updateCharts2&&r.updateCharts2(...t))},null,40,ot),[[C.Jo,o.date]])]),rt,(0,s.Lk)("div",lt,[(0,s.Lk)("div",dt,[(0,s.Lk)("canvas",{id:o.mileChartId[0],class:"chartMile"},null,8,ct)]),(0,s.Lk)("div",ht,[(0,s.Lk)("div",gt,[(0,s.Lk)("div",pt,[ut,(0,s.Lk)("p",mt,(0,i.v_)(o.best),1),ft,yt,(0,s.Lk)("p",bt,(0,i.v_)(o.worst),1)])])])])])]),kt])}H.t1.register(...H.$L);var Lt={name:"MileagePageCount",data(){return{mileChart:{},date:"",mileChartId:["MileChart"],todayDate:(new Date).toISOString().split("T")[0],best:"-",worst:"-"}},computed:{maxDate(){const t=new Date,a=new Date(t);return a.setDate(t.getDate()-1),a.toISOString().split("T")[0]},...(0,y.L8)("login",["getLoginInfo"]),loginInfo(){return this.getLoginInfo}},methods:{async downloadChart(){try{const{hitCounts:t}=await this.realChartData(),a=await this.label(),e=this.date,s=[["기준일자","마일리지","방문자 수"]];s.push([e]),a.forEach(((a,e)=>{s.push(["",a,t[e]||0])}));const i=Z.Wp.aoa_to_sheet(s),n=Z.Wp.book_new();Z.Wp.book_append_sheet(n,i,"Data"),Z._h(n,`mileage_visitors_data_${e}.xlsx`)}catch(t){console.error("Error downloading mileage_visitors data:",t),L().fire({icon:"error",title:"Error",text:"차트 데이터 다운로드 중 오류가 발생했습니다."})}},async updateCharts2(){try{const{hitCounts:t}=await this.realChartData(),a=await this.label();this.findMaxAndMinAndSet(t,a),this.renderChart2(t,a)}catch(t){console.error("Error fetching chart data:",t)}},async label(){try{const t=await q.A.get("/mileage/getMileage"),a=t.data.map((t=>t.mile_name));return a}catch(t){return console.error("Error fetching mileage labels:",t),[]}},async realChartData(){try{const t=await q.A.post("/mileage/hit_mileChartDATE",{date:this.date});if(!t.data||!Array.isArray(t.data))throw new Error("Invalid response data format");const a=t.data.map((t=>t.hit_count));return console.log("마일리지 결과",a),{hitCounts:a}}catch(t){return console.error("Error fetching chart data:",t),{hitCounts:[]}}},findMaxAndMinAndSet(t,a){if(0===t.length||0===a.length)return this.best="-",void(this.worst="-");let e=0,s=0,i=t[0],n=t[0];for(let o=1;o<t.length;o++)t[o]>i&&(i=t[o],e=o),(t[o]<n||t[o]===n&&0!==t[o])&&(n=t[o],s=o);this.best=a[e],this.worst=a[s],console.log("Best:",this.best,"Worst:",this.worst,"Max Value:",i,"Min Value:",n)},renderChart2(t,a){const e=this.mileChartId[0],s=document.getElementById(e);if(s){this.mileChart[e]&&this.mileChart[e].destroy();try{this.mileChart[e]=new H.t1(s,{type:"bar",data:{labels:a,datasets:[{label:"방문자 수",data:t,backgroundColor:["rgba(155, 241, 218,0.8)","rgba(255, 235, 163,0.8)","rgba(216,216,216,0.8)"],borderColor:["rgba(155, 241, 218,1)","rgba(255, 235, 163,1)","rgba(216,216,216,1)"],borderWidth:1,barThickness:40}]},options:{plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{display:!0},grid:{drawBorder:!1,display:!0}},x:{grid:{drawBorder:!1,display:!1}}},layout:{padding:{left:0,right:0,top:0,bottom:0}},maintainAspectRatio:!1,responsive:!0}})}catch(i){console.error("Error rendering chart:",i)}}else console.error(`Canvas element with id '${e}' not found.`)},setInitialDate(){const t=new Date,a=new Date(t);a.setDate(t.getDate()-1);const e=a.toISOString().split("T")[0];this.date=e}},mounted(){this.setInitialDate(),this.updateCharts2()}};const Ct=(0,N.A)(Lt,[["render",vt],["__scopeId","data-v-cb0355e2"]]);var wt=Ct;const Dt=t=>((0,s.Qi)("data-v-7affa3c0"),t=t(),(0,s.jt)(),t),xt={class:"cards",style:{"background-color":"#f9f9f9",height:"430px",padding:"20px"}},_t={class:"text-left lg2 KB_C2"},It={class:"cards favorite-card",style:{height:"330px",display:"flex","align-items":"center"}},Et={class:"sub",style:{width:"100%"}},At={class:"container2 mt-5",style:{width:"45%"}},St=["id"],Mt={class:"chart-container mt-4",style:{width:"40%","padding-left":"20px"}},Pt={class:"text-right mb-5"},Bt=["max"],$t={class:"d-flex justify-content-center",style:{width:"100%","margin-top":"60px"}},Ft={class:"table table-sm custom-table ml-3",style:{width:"80%"}},Tt=Dt((()=>(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"직급"),(0,s.Lk)("td",null,"L0"),(0,s.Lk)("td",null,"L1"),(0,s.Lk)("td",null,"L2"),(0,s.Lk)("td",null,"L3"),(0,s.Lk)("td",null,"L4")])],-1))),Wt=Dt((()=>(0,s.Lk)("th",null,"카운트",-1))),Vt=Dt((()=>(0,s.Lk)("div",{class:"text-end w-100 mt-5"},[(0,s.Lk)("span",{style:{position:"absolute",top:"86%",right:"-50px",transform:"translateX(-50%)","z-index":"0","font-size":"10pt",color:"gray"}},"( 최대 조회 가능일 : 전영업일 )")],-1)));function zt(t,a,e,n,o,r){return(0,s.uX)(),(0,s.CE)("div",xt,[(0,s.Lk)("div",null,[(0,s.Lk)("p",_t,[(0,s.eW)("직급별 방문자 수   "),(0,s.Lk)("i",{class:"bi bi-download",onClick:a[0]||(a[0]=(...t)=>r.downloadChart&&r.downloadChart(...t))})]),(0,s.Lk)("div",It,[(0,s.Lk)("div",Et,[(0,s.Lk)("div",At,[(0,s.Lk)("canvas",{id:o.positionChartId[0],class:"positionchart",style:{height:"250px"}},null,8,St)]),(0,s.Lk)("div",Mt,[(0,s.Lk)("div",Pt,[(0,s.bo)((0,s.Lk)("input",{type:"date",class:"date",id:"date","onUpdate:modelValue":a[1]||(a[1]=t=>o.date=t),max:r.maxDate,onChange:a[2]||(a[2]=(...t)=>r.updateCharts3&&r.updateCharts3(...t))},null,40,Bt),[[C.Jo,o.date]])]),(0,s.Lk)("div",$t,[(0,s.Lk)("table",Ft,[Tt,(0,s.Lk)("tbody",null,[(0,s.Lk)("tr",null,[Wt,(0,s.Lk)("td",null,(0,i.v_)(o.data[0]),1),(0,s.Lk)("td",null,(0,i.v_)(o.data[1]),1),(0,s.Lk)("td",null,(0,i.v_)(o.data[2]),1),(0,s.Lk)("td",null,(0,i.v_)(o.data[3]),1),(0,s.Lk)("td",null,(0,i.v_)(o.data[4]),1)])])])])])])])]),Vt])}H.t1.register(...H.$L);var Ot={name:"PositionChart",data(){return{positionChart:{},date:"",positionChartId:["PositionChart"],todayDate:(new Date).toISOString().split("T")[0],data:Array.from({length:5},(()=>"-"))}},computed:{maxDate(){const t=new Date,a=new Date(t);return a.setDate(t.getDate()-1),a.toISOString().split("T")[0]},...(0,y.L8)("login",["getLoginInfo"]),loginInfo(){return this.getLoginInfo}},methods:{async downloadChart(){try{const t=await this.realChartData(),a=["L0","L1","L2","L3","L4"],e=this.date,s=[["기준일자","직급별","방문자 수"]];s.push([e]),a.forEach(((a,e)=>{s.push(["",a,t[e]||0])}));const i=Z.Wp.aoa_to_sheet(s),n=Z.Wp.book_new();Z.Wp.book_append_sheet(n,i,"Data"),Z._h(n,`position_visitors_data_${e}.xlsx`)}catch(t){console.error("Error downloading position_visitors data:",t),L().fire({icon:"error",title:"Error",text:"차트 데이터 다운로드 중 오류가 발생했습니다."})}},async updateCharts3(){try{const t=await this.realChartData();this.data=t,this.renderChart3(t)}catch(t){console.error("Error fetching chart data:",t)}},async realChartData(){try{const t=await q.A.post("/user/levelChartData",{date:this.date});if(!t.data||!Array.isArray(t.data))throw new Error("Invalid response data format");const a=t.data.map((t=>t.visitorCount));return console.log("원형차트 결과",a),a}catch(t){return console.error("Error fetching chart data:",t),[]}},renderChart3(t){const a=this.positionChartId[0],e=document.getElementById(a);if(e){this.positionChart[a]&&this.positionChart[a].destroy();try{this.positionChart[a]=new H.t1(e,{type:"pie",data:{labels:["L0","L1","L2","L3","L4"],datasets:[{data:t,backgroundColor:["#FFAAE7","#FFE78F","#9FEDD1","#B5EDFF","#E4E4E4"],borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"70%",plugins:{legend:{display:!0,position:"right",padding:20}}},layout:{padding:{top:20,bottom:30}}})}catch(s){console.error("Error rendering chart:",s)}}else console.error(`Canvas element with id '${a}' not found.`)},setInitialDate(){const t=new Date,a=new Date(t);a.setDate(t.getDate()-1);const e=a.toISOString().split("T")[0];this.date=e}},mounted(){this.setInitialDate(),this.updateCharts3()}};const Xt=(0,N.A)(Ot,[["render",zt],["__scopeId","data-v-7affa3c0"]]);var jt=Xt,Rt={name:"AdminMainView",components:{PageCount:tt,MileagePageCount:wt,PositionChart:jt},computed:{...(0,y.L8)("login",["getLoginInfo"]),profileImageUrl(){return this.loginInfo&&this.loginInfo.user_no?`/profile/${this.loginInfo.user_no}.jpg`:""},loginInfo(){return this.getLoginInfo}},mounted(){this.checkFirstBusinessDay(),this.$nextTick((()=>{const t=this.$el.querySelectorAll(".fade-up-item");t.forEach(((t,a)=>{t.style.setProperty("--index",a),t.style.setProperty("z-index",10-a),setTimeout((()=>{t.classList.add("fade-up-active")}),100*a)}))}))},methods:{setDefaultImage(t){t.target.src=e(6468)},setTransitionDelay(t,a){t.style.setProperty("--index",a)},checkFirstBusinessDay(){const t=k()();let a=t.clone();while(a.month()===t.month()){if(0!==a.day()&&6!==a.day()&&0===a.date()){L().fire({icon:"info",title:"알림",text:"마왕 채택일입니다. 채택을 진행해주세요."}).then((t=>{t.isConfirmed&&(window.location.href="/kingMain")}));break}a.add(1,"day")}}}};const Ut=(0,N.A)(Rt,[["render",f],["__scopeId","data-v-47b2c606"]]);var Kt=Ut}}]);
//# sourceMappingURL=1270.2f7bc300.js.map