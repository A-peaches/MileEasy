"use strict";(self["webpackChunkmile"]=self["webpackChunkmile"]||[]).push([[6291],{6291:function(t,e,o){o.r(e),o.d(e,{default:function(){return yt}});var i=o(641),n=o(33),s=o(3751);const a=t=>((0,i.Qi)("data-v-7109824f"),t=t(),(0,i.jt)(),t),l={class:"app-container"},r={key:0,class:"content cards"},c={class:"header"},m={class:"button-container"},d=a((()=>(0,i.Lk)("span",{class:"arrow"},"❮",-1))),p={class:"actions"},u={key:0},g={key:1},_=a((()=>(0,i.Lk)("span",{style:{"font-size":"25pt"}},"🚨",-1))),h={class:"content"},f={key:0,class:"new-label"},y={class:"title"},k={class:"meta"},b={class:"author"},C={class:"date"},L={class:"main-content"},v={class:"body"},w={class:"file cards"},E={style:{display:"flex","align-items":"center"}},I=a((()=>(0,i.Lk)("h2",{style:{"margin-right":"10px"}},"첨부파일",-1))),x={key:0,style:{color:"#4b4a4a","font-family":"'KB_S5',sans-serif","margin-left":"2%","white-space":"nowrap"}},B={key:0,style:{"margin-top":"10px"}},D={class:"stats-container"},N={class:"icon-container"},X=a((()=>(0,i.Lk)("div",{class:"views-icon"},[(0,i.Lk)("i",{class:"bi bi-eye"})],-1))),$={class:"views-text"},A={class:"icon-container"},K={class:"views-text"},T=a((()=>(0,i.Lk)("hr",{style:{"margin-top":"100px"}},null,-1))),U={key:1},z={key:0},R={key:1};function M(t,e,o,a,M,P){const Q=(0,i.g2)("UserComment");return(0,i.uX)(),(0,i.CE)("div",l,[P.notice?((0,i.uX)(),(0,i.CE)("div",r,[(0,i.Lk)("div",c,[(0,i.Lk)("div",m,[(0,i.Lk)("button",{class:"back-button",onClick:e[0]||(e[0]=(...t)=>P.goBack&&P.goBack(...t))},[d,(0,i.eW)(" 이전 ")])]),(0,i.Lk)("div",p,[P.isLoggedIn&&P.notice.user_no===P.loginInfo.user_no?((0,i.uX)(),(0,i.CE)("div",u,[(0,i.Lk)("button",{class:"edit-button",onClick:e[1]||(e[1]=(...t)=>P.goToModifyView&&P.goToModifyView(...t))},"수정"),(0,i.Lk)("button",{class:"delete-button",onClick:e[2]||(e[2]=(...t)=>P.deleteNotice&&P.deleteNotice(...t))},"삭제")])):P.isLoggedIn&&P.loginInfo.user_is_admin&&!P.loginInfo.user_is_manager&&P.isChecked?((0,i.uX)(),(0,i.CE)("div",g,[(0,i.Lk)("button",{class:"report-button",onClick:e[3]||(e[3]=(...e)=>t.reportNotice&&t.reportNotice(...e))},"신고하기"),_])):(0,i.Q3)("",!0)])]),(0,i.Lk)("div",h,[P.isNew(P.notice.mtip_board_date)?((0,i.uX)(),(0,i.CE)("span",f,"NEW")):(0,i.Q3)("",!0),(0,i.Lk)("h1",y,(0,n.v_)(P.notice.mtip_board_title),1),(0,i.Lk)("div",k,[(0,i.Lk)("span",b,(0,n.v_)(P.notice.user_name),1),(0,i.Lk)("span",C,(0,n.v_)(P.formatDate(P.notice?.mtip_board_date)),1)]),(0,i.Lk)("div",L,[(0,i.Lk)("div",v,[(0,i.Lk)("pre",null,[(0,i.Lk)("p",null,(0,n.v_)(P.notice.mtip_board_content),1)])]),(0,i.Lk)("div",w,[(0,i.Lk)("div",E,[I,P.notice.mtip_board_file?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("span",x,"파일이 존재하지 않습니다."))]),P.notice.mtip_board_file?((0,i.uX)(),(0,i.CE)("div",B,[(0,i.Lk)("a",{onClick:e[4]||(e[4]=(0,s.D$)(((...t)=>P.downloadFile&&P.downloadFile(...t)),["prevent"])),href:"#",class:"file-download-link"},(0,n.v_)(P.getDisplayFileName(P.notice.mtip_board_file)),1)])):(0,i.Q3)("",!0)])]),(0,i.Lk)("div",D,[(0,i.Lk)("div",N,[X,(0,i.Lk)("div",$,(0,n.v_)(P.notice.mtip_board_hit),1)]),(0,i.Lk)("div",A,[(0,i.Lk)("div",{class:"heart-icon",onClick:e[5]||(e[5]=(...t)=>P.toggleLike&&P.toggleLike(...t))},[(0,i.Lk)("i",{class:(0,n.C4)(["bi",P.computedIsPostLiked?"bi-heart-fill":"bi-heart"]),style:(0,n.Tr)({color:P.computedIsPostLiked?"#dc3545":"inherit"})},null,6)]),(0,i.Lk)("div",K,(0,n.v_)(P.notice.mtip_board_like),1)])]),T,(0,i.bF)(Q,{"login-info":P.loginInfo,mtip_board_no:P.notice.mtip_board_no},null,8,["login-info","mtip_board_no"])])])):((0,i.uX)(),(0,i.CE)("div",U,[M.isLoading?((0,i.uX)(),(0,i.CE)("p",z,"Loading...")):((0,i.uX)(),(0,i.CE)("p",R,"No data available"))]))])}o(4114),o(4603),o(7566),o(8721);var P=o(7682),Q=o(6278),V=o(8465),F=o.n(V);const j=t=>((0,i.Qi)("data-v-49e0b910"),t=t(),(0,i.jt)(),t),O={class:"comments-section"},S={class:"comments-header"},W=j((()=>(0,i.Lk)("i",{class:"bi bi-chat-right-text",style:{"font-size":"20px","margin-right":"10px"}},null,-1))),q={style:{"font-size":"17px","font-family":"'KB_C2', sans-serif","text-align":"left",margin:"0"}},G={class:"comment-input",style:{width:"100%"}},J={key:0},H=["src"],Y={class:"comment-content"},Z={class:"comment-meta"},tt={class:"comment-user",style:{"font-family":"'KB_C2', sans-serif","font-size":"18px","margin-right":"15px"}},et={class:"comment-date",style:{"font-family":"'KB_C2', sans-serif","font-size":"14px"}},ot={class:"comment-actions",style:{"margin-left":"50px"}},it={key:0},nt=["onClick"],st=["onClick"],at=["onClick"],lt={key:0},rt=["onUpdate:modelValue"],ct={key:1,class:"comment-text",style:{"font-family":"'KB_C2', sans-serif","font-size":"18px","margin-right":"50%","text-align":"left"}},mt={key:1,style:{"font-family":"'KB_C2', sans-serif","font-size":"15px","margin-top":"100px"}};function dt(t,e,o,a,l,r){return(0,i.uX)(),(0,i.CE)("div",O,[(0,i.Lk)("div",S,[W,(0,i.Lk)("h3",q,"댓글 ("+(0,n.v_)(r.comments.length)+")",1)]),(0,i.Lk)("div",G,[(0,i.bo)((0,i.Lk)("textarea",{class:"input-base",placeholder:"댓글을 입력해주세요","onUpdate:modelValue":e[0]||(e[0]=t=>l.newComment=t),onKeydown:e[1]||(e[1]=(0,s.jR)((0,s.D$)(((...t)=>r.addComment&&r.addComment(...t)),["prevent"]),["enter"])),style:{"font-family":"'KB_C2', sans-serif","font-size":"18px",width:"100%",height:"80px",resize:"none",padding:"10px","text-align":"left"}},null,544),[[s.Jo,l.newComment]]),(0,i.Lk)("button",{class:"btn-yellow btn-yellow:hover",onClick:e[2]||(e[2]=(...t)=>r.addComment&&r.addComment(...t)),style:{"font-family":"'KB_C2', sans-serif","font-size":"18px",width:"80px",height:"80px",color:"#4b4a4a"}},"등록")]),r.comments&&r.comments.length?((0,i.uX)(),(0,i.CE)("div",J,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.comments,(t=>((0,i.uX)(),(0,i.CE)("div",{class:"comment",key:t.mtip_reply_no},[t&&t.user_no?((0,i.uX)(),(0,i.CE)("img",{key:0,src:r.profileImageUrl(t.user_no),class:"profile-small my-3",alt:"Profile Picture",onError:e[3]||(e[3]=(...t)=>r.setDefaultImage&&r.setDefaultImage(...t))},null,40,H)):(0,i.Q3)("",!0),(0,i.Lk)("div",Y,[(0,i.Lk)("div",Z,[(0,i.Lk)("span",tt,(0,n.v_)(t.user_name),1),(0,i.Lk)("span",et,(0,n.v_)(r.formatDate(t.mtip_reply_date)),1),(0,i.Lk)("div",ot,[t.user_no===o.loginInfo.user_no?((0,i.uX)(),(0,i.CE)("div",it,[t.isEditing?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("button",{key:0,class:"edit-button",onClick:e=>r.startEditing(t),style:{color:"#714319"}},"수정",8,nt)),t.isEditing?((0,i.uX)(),(0,i.CE)("button",{key:1,class:"edit-button",onClick:e=>r.finishEditing(t),style:{color:"#714319"}},"수정완료",8,st)):(0,i.Q3)("",!0),(0,i.eW)("   "),(0,i.Lk)("button",{class:"delete-button",onClick:e=>r.deleteComment(t.mtip_reply_no),style:{color:"red"}},"삭제",8,at)])):(0,i.Q3)("",!0)])]),t.isEditing?((0,i.uX)(),(0,i.CE)("div",lt,[(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":e=>t.editingContent=e,class:"input-base",style:{"font-family":"'KB_C2', sans-serif","min-height":"30px",height:"auto","font-size":"18px",width:"100%",resize:"none","overflow-y":"hidden","line-height":"2","text-align":"left","box-sizing":"border-box"}},null,8,rt),[[s.Jo,t.editingContent]])])):((0,i.uX)(),(0,i.CE)("div",ct,(0,n.v_)(t.mtip_reply_content),1))])])))),128))])):((0,i.uX)(),(0,i.CE)("div",mt," 해당 게시글의 댓글이 없습니다. "))])}var pt={name:"UserComment",props:{loginInfo:{type:Object,required:!0},mtip_board_no:{type:Number,required:!0}},data(){return{newComment:""}},watch:{mtip_board_no:{immediate:!0,handler(t,e){t!==e&&this.fetchComments()}}},created(){console.log("UserComment component created 확인해보기"),console.log("mtip_board_no 확인 중:",this.mtip_board_no),console.log("loginInfo 확인 중:",this.loginInfo),console.log("API URL 확인 중:","http://210.114.18.177:80,http://digicampus01.cafe24.com:80"),this.$store.dispatch("mtipReply/fetchComments",this.mtip_board_no)},computed:{...(0,Q.L8)("mtipReply",["getComments"]),comments(){return this.getComments}},methods:{...(0,Q.i0)("mtipReply",["fetchComments","addComment","updateComment","deleteComment"]),profileImageUrl(t){return null!=t?`/profile/${t}.jpg`:""},getInitials(t){return t?t.charAt(0).toUpperCase():"?"},startEditing(t){t.isEditing=!0,t.editingContent=t.mtip_reply_content},async fetchComments(){console.log("Fetching comments...");try{const t=await P.A.get(`/mtip/comments/${this.mtip_board_no}`);console.log("서버에서 댓글 정보 가져오기 :",t.data),this.comments=t.data.map((t=>({...t,isEditing:!1,editingContent:t.mtip_reply_content})))}catch(t){console.error("댓글 가져오기 중 오류가 발생했습니다:",t)}},async addComment(){if(!this.newComment.trim())return;const t={user_no:this.loginInfo.user_no,user_name:this.loginInfo.user_name,mtip_board_no:this.mtip_board_no,mtip_reply_content:this.newComment.trim()};console.log("commentData:",t);try{const e=await P.A.post("/mtip/comments",t);this.comments.unshift(e.data),this.newComment="",window.location.reload()}catch(e){console.error("댓글 등록 중 오류가 발생했습니다:",e)}},setDefaultImage(t){t.target.src=o(6468)},formatDate(t){const e={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1};return new Date(t).toLocaleString("ko-KR",e)},goToModifyView(t){this.newComment=t.mtip_reply_content,this.editingCommentId=t.mtip_reply_no},async finishEditing(t){if(!t.editingContent.trim())return;const e={mtip_reply_no:t.mtip_reply_no,mtip_reply_content:t.editingContent.trim()};try{await P.A.post(`/mtip/updateComment/${t.mtip_reply_no}`,e),t.mtip_reply_content=t.editingContent.trim(),t.isEditing=!1}catch(o){console.error("댓글 수정 중 오류가 발생했습니다:",o)}},async deleteComment(t){try{await P.A.delete(`/mtip/deleteComment/${t}`),this.$store.commit("mtipReply/DELETE_COMMENT",t)}catch(e){console.error("댓글 삭제 중 오류가 발생했습니다:",e)}}},beforeRouteUpdate(t,e,o){t.params.mtip_board_no!==e.params.mtip_board_no&&this.$store.dispatch("mtipReply/fetchComments",t.params.mtip_board_no),o()}},ut=o(6262);const gt=(0,ut.A)(pt,[["render",dt],["__scopeId","data-v-49e0b910"]]);var _t=gt,ht={name:"M_TipDetailView",props:["mtip_board_no"],data(){return{isLoading:!0,comments:[]}},components:{UserComment:_t},methods:{...(0,Q.i0)("mtipBoard",["fetchNoticeDetail","toggleLikeAction"]),async toggleLike(){if(this.loginInfo)if(this.notice)try{await this.toggleLikeAction({mtip_board_no:this.notice.mtip_board_no,user_no:this.loginInfo.user_no})}catch(t){console.error("Error toggling like:",t)}else console.error("Notice data is not available");else alert("로그인이 필요합니다.")},async deleteNotice(){F().fire({title:"정말로 삭제하시겠습니까?",text:"다시 되돌릴 수 없습니다.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#4b4a4a",cancelButtonColor:"#bd2c3a",confirmButtonText:"확인",cancelButtonText:"취소",reverseButtons:!1}).then((async t=>{if(t.isConfirmed)try{await P.A.delete(`/mtip/delete/${this.notice.mtip_board_no}`),F().fire("게시글 삭제 완료","게시글이 삭제 되었습니다.","success").then((()=>{this.$router.push("/M_TipListView")}))}catch(e){console.error("게시글 삭제 중 오류가 발생했습니다.",e),F().fire("게시글 삭제 중 오류가 발생했습니다.","","error")}}))},showAlert(t,e){this.$swal({title:t,icon:e,confirmButtonText:"확인",confirmButtonColor:"#4b4a4a",allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,stopKeydownPropagation:!1,scrollbarPadding:!1,backdrop:!0,didOpen:()=>{document.body.classList.add("no-scroll"),document.documentElement.style.overflow="hidden"},willClose:()=>{document.body.classList.remove("no-scroll"),document.documentElement.style.overflow=""}})},getDisplayFileName(t){const e=37;return!t||t.length<=e?t:"_"===t.charAt(e-1)?t.substring(e):t},goBack(){this.$router.go(-1)},goToModifyView(){console.log("modify 화면으로 넘긴 정보:",this.notice.mtip_board_no),this.$router.push({name:"m_TipModifyView",params:{mtip_board_no:this.notice.mtip_board_no}})},isNew(t){const e=new Date,o=new Date(t),i=Math.abs(e-o),n=Math.ceil(i/864e5);return n<=7},formatDate(t){if(console.log("Formatting date:",t),!t)return"Date not available";const e=new Date(t);if(isNaN(e.getTime()))return console.error("Invalid date string:",t),"Invalid Date";const o={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1};return e.toLocaleString("ko-KR",o)},async downloadFile(){try{console.log("글쓰기 상세보기 fileName :",this.notice.mtip_board_file);const t=encodeURIComponent(this.notice.mtip_board_file),e=await(0,P.A)({url:`/mtip/downloadGuide/${t}`,method:"GET",responseType:"blob"}),o=window.URL.createObjectURL(new Blob([e.data])),i=document.createElement("a");i.href=o,i.setAttribute("download",this.notice.mtip_board_file),document.body.appendChild(i),i.click(),document.body.removeChild(i)}catch(t){console.error("파일 다운로드 중 오류 발생:",t),this.showAlert("파일 다운로드 중 오류가 발생했습니다.","error")}},async fetchNoticeDetail(t){this.isLoading=!0,await this.$store.dispatch("mtipBoard/fetchNoticeDetail",t),this.isLoading=!1}},computed:{...(0,Q.L8)("login",["getLoginInfo","getIsChecked"]),...(0,Q.L8)("mtipBoard",["getNotice","isPostLiked"]),...(0,Q.aH)("login",["loginInfo"]),notice(){return this.getNotice||null},loginInfo(){return this.getLoginInfo},isChecked(){return this.getIsChecked},isLoggedIn(){return!!this.loginInfo},mileNo(){return this.$route.params.notice.mtip_board_no},computedIsPostLiked(){return this.isPostLiked(this.loginInfo.user_no,this.notice.mtip_board_no)}},async mounted(){const t=this.$route.params.mtip_board_no;t&&await this.fetchNoticeDetail(t)}};const ft=(0,ut.A)(ht,[["render",M],["__scopeId","data-v-7109824f"]]);var yt=ft}}]);
//# sourceMappingURL=6291.c58d8e76.js.map