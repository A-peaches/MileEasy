"use strict";(self["webpackChunkmile"]=self["webpackChunkmile"]||[]).push([[4629],{4629:function(e,t,i){i.r(t),i.d(t,{default:function(){return T}});var o=i(641),n=i(3751),l=i(33);const s=e=>((0,o.Qi)("data-v-5dc591cf"),e=e(),(0,o.jt)(),e),a={class:"app-container"},r={class:"content cards"},d={class:"header"},c={class:"button-container"},p=s((()=>(0,o.Lk)("span",{class:"arrow"},"❮",-1))),u=s((()=>(0,o.Lk)("div",{class:"actions"},[(0,o.Lk)("h1",{class:"title"},"M-Tip 수정")],-1))),m={class:"form-group"},f=s((()=>(0,o.Lk)("label",{for:"title"},"제목",-1))),h={class:"form-group content"},g=s((()=>(0,o.Lk)("label",{for:"content"},"내용",-1))),k={class:"form-group file-upload"},_=s((()=>(0,o.Lk)("label",{for:"file"},"첨부파일",-1))),L={class:"custom-file-upload"},b={key:0},F={class:"file-info"},y={key:1},v=s((()=>(0,o.Lk)("div",{class:"btn-yellow-container"},[(0,o.Lk)("button",{type:"submit",class:"btn-yellow"},"수정")],-1)));function I(e,t,i,s,I,N){return(0,o.uX)(),(0,o.CE)("div",a,[(0,o.Lk)("div",r,[(0,o.Lk)("div",d,[(0,o.Lk)("div",c,[(0,o.Lk)("button",{class:"back-button",onClick:t[0]||(t[0]=(...e)=>N.goBack&&N.goBack(...e))},[p,(0,o.eW)(" 이전 ")])])]),u,(0,o.Lk)("form",{onSubmit:t[6]||(t[6]=(0,n.D$)(((...e)=>N.submitForm&&N.submitForm(...e)),["prevent"]))},[(0,o.Lk)("div",m,[f,(0,o.bo)((0,o.Lk)("input",{type:"text",id:"title","onUpdate:modelValue":t[1]||(t[1]=e=>I.form.title=e),placeholder:"제목을 입력해주세요",class:"title-input"},null,512),[[n.Jo,I.form.title]])]),(0,o.Lk)("div",h,[g,(0,o.bo)((0,o.Lk)("textarea",{id:"content","onUpdate:modelValue":t[2]||(t[2]=e=>I.form.content=e),placeholder:"내용을 입력해주세요"},null,512),[[n.Jo,I.form.content]])]),(0,o.Lk)("div",k,[_,(0,o.Lk)("div",L,[I.displayFileName?((0,o.uX)(),(0,o.CE)("div",b,[(0,o.Lk)("div",F,[(0,o.Lk)("span",null,(0,l.v_)(I.displayFileName),1),(0,o.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>N.triggerFileInput&&N.triggerFileInput(...e)),type:"button",class:"file-modify-button"}," 파일 수정 ")]),(0,o.Lk)("input",{type:"file",onChange:t[4]||(t[4]=(...e)=>N.handleFileUpload&&N.handleFileUpload(...e)),ref:"fileInput",style:{display:"none"}},null,544)])):((0,o.uX)(),(0,o.CE)("div",y,[(0,o.Lk)("input",{type:"file",onChange:t[5]||(t[5]=(...e)=>N.handleFileUpload&&N.handleFileUpload(...e)),ref:"fileInput"},null,544)]))])]),v],32)])])}i(4114);var N=i(7682),w=i(6278),C={name:"mTipGuideModify",data(){return{form:{notice_board_no:"",title:"",file:"",content:"",user_no:"",user_name:"",mtipGuideNo:null,mtip_guide_no:null},uploadedFileName:"",displayFileName:"",mileages:[]}},computed:{...(0,w.L8)("login",["getLoginInfo"]),...(0,w.L8)("login",["getIsChecked"]),decodedFileName(){if(this.uploadedFileName){const e=this.uploadedFileName.split("_",2);if(e.length>1)return decodeURIComponent(e[1])}return""}},mounted(){this.MtipGuideDetail(),this.setUserInfo(),document.addEventListener("click",this.handleClickOutside)},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside)},methods:{checkLoginInfo(){this.getLoginInfo&&!1!==this.getIsChecked&&!1!==this.getLoginInfo.user_is_admin||(window.location.href="/noAccess")},async handleFileUpload(e){const t=e.target.files[0];if(!t)return;const i=new FormData;i.append("files",t);try{const e=await N.A.post("/notice/mTipGuideUpload",i,{headers:{"Content-Type":"multipart/form-data"}});console.log("서버 응답:",e.data);const[t,o]=e.data.split(",");console.log("저장된 파일명:",t),console.log("원본 파일명:",o),this.uploadedFileName=t,this.displayFileName=o,this.form.file=t}catch(o){console.error("파일 업로드 중 오류 발생:",o),this.showAlert("파일 업로드 중 오류가 발생했습니다.","error")}},getDisplayFileName(e){const t=37;return!e||e.length<=t?e:"_"===e.charAt(t-1)?e.substring(t):e},async submitForm(){const e=new FormData;e.append("mtip_guide_no",this.form.mtip_guide_no),e.append("mtip_guide_title",this.form.title),e.append("mtip_guide_content",this.form.content),e.append("user_no",this.form.user_no),e.append("user_name",this.form.user_name),this.form.file?(e.append("file",this.form.file),e.append("originalFileName",this.displayFileName)):this.displayFileName&&e.append("originalFileName",this.displayFileName);for(let[i,o]of e.entries())console.log(`${i}: ${o}`);try{const t=await N.A.post("/notice/GuideUpdate",e,{headers:{"Content-Type":"multipart/form-data"}});console.log("서버 응답:",t.data),200===t.status?(this.showAlert("M-Tip가이드가 수정되었습니다.","success"),this.$router.push("/mTipMainAdminView")):this.showAlert("M-Tip가이드 수정 중 오류가 발생했습니다.","error")}catch(t){console.error("Error submitting form:",t),this.showAlert("M-Tip가이드 수정 중 오류가 발생했습니다.","error")}},goBack(){this.$router.go(-1)},triggerFileInput(){const e=this.$refs.fileInput;e?e.click():console.error("fileInput reference is not available.")},setUserInfo(){const e=this.getLoginInfo;e&&(this.form.user_no=e.user_no,this.form.user_name=e.user_name)},MtipGuideDetail(){console.log("왓나?",this.$route.params.mtipGuideNo);const e=this.$route.params.mtipGuideNo;N.A.get(`/notice/Guide/${e}`).then((e=>{const t=e.data;this.form.mtip_guide_no=t.mtip_guide_no,this.form.title=t.mtip_guide_title,this.form.content=t.mtip_guide_content,this.displayFileName=t.mtip_guide_file})).catch((e=>{console.error("Error fetching notice details:",e.response?e.response.data:e.message)}))},showAlert(e,t){this.$swal({title:e,icon:t,confirmButtonText:"확인",confirmButtonColor:"#4b4a4a",scrollbarPadding:!1})}},created(){this.checkLoginInfo()}},U=i(6262);const A=(0,U.A)(C,[["render",I],["__scopeId","data-v-5dc591cf"]]);var T=A}}]);
//# sourceMappingURL=4629.46549304.js.map