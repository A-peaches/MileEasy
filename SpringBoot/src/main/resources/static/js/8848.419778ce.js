"use strict";(self["webpackChunkmile"]=self["webpackChunkmile"]||[]).push([[8848],{8848:function(t,e,n){n.r(e),n.d(e,{default:function(){return J}});var o=n(641),i=n(33),r=n(3751);const s={class:"bold-x-lg my-5",style:{"font-family":"KB_C3"}},l={class:"d-flex justify-content-between align-items-center"},a={class:"lg2",style:{padding:"3em"}},c={class:"input-search input-base",style:{"margin-right":"2em",width:"17vw",height:"6vh"}},u={class:"d-flex justify-content-between align-items-center",style:{"font-size":"14pt",height:"100%","margin-left":"1em"}},h=(0,o.Lk)("button",null,[(0,o.Lk)("i",{class:"bi bi-search mr-2",style:{"font-size":"25px",color:"#4b4a4a"}})],-1),f={key:0,class:"pr-5 pl-5 pb-5 pt-4",style:{"margin-top":"10vh"}},d=["onClick"],m={class:"d-flex align-items-center justify-content-between"},g={style:{width:"80%","text-align":"left"}},p={class:"d-flex align-items-center justify-content-start"},y={key:0,style:{width:"5%","padding-left":"3%"}},v=(0,o.Lk)("span",{class:"md",style:{color:"#edbb00"}},"NEW",-1),w=[v],b={class:"d-flex align-items-center justify-content-between",style:{width:"100%"}},D={class:"lg2 pl-5",style:{"margin-left":"3%","text-align":"left","font-family":"KB_C2"}},k={class:"md pl-3",style:{width:"15%","margin-right":"2%","text-align":"right","font-family":"KB_C3"}},L=["onClick"],x=(0,o.Lk)("span",{class:"md",style:{"text-align":"right"}},"파일 다운로드 〉",-1),C=[x],M={key:1,style:{"padding-top":"10vh"}},A=(0,o.Lk)("p",{class:"lg2",style:{"text-align":"center",color:"#aeaeb2","font-family":"KB_C2"}},"검색 결과가 없습니다.",-1),I=[A],_={key:2,style:{"margin-bottom":"3%"}},P=(0,o.Lk)("i",{class:"bi bi-arrow-clockwise lg2"},null,-1),O={class:"button-container mt-auto"},E={class:"d-flex justify-content-evenly mx-auto"},S={class:"mt-5"},j={class:"mt-5"},B={key:0,class:"modals"},T={class:"modals-content",ref:"modal",style:{width:"40%",height:"45%","background-color":"#f9f9f9"}},K=(0,o.Lk)("p",{class:"text-left fw-bold mb-3",style:{"font-size":"19pt"}}," 마일리지 문서 업로드 ",-1),F={class:"p-4",style:{"margin-top":"5vh"}},Q={class:"d-flex input-gray mt-3 p-4"},X={class:"d-flex justify-content-center",style:{"margin-top":"8vh"}};function z(t,e,n,v,x,A){return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",{class:"cards page-back mx-auto",style:(0,i.Tr)({height:A.computedHeight})},[(0,o.Lk)("h2",s,(0,i.v_)(A.mileInfo?A.mileInfo.mile_no:"")+" 마일리지 문서",1),(0,o.Lk)("div",l,[(0,o.Lk)("div",a,"총 "+(0,i.v_)(A.documentSum)+"건",1),(0,o.Lk)("div",c,[(0,o.Lk)("div",u,[(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>x.searchQuery=t),onInput:e[1]||(e[1]=(...t)=>A.onSearch&&A.onSearch(...t)),placeholder:"검색어를 입력하세요",class:"w-100 h-100 d-inline-block",style:{"text-align":"left"}},null,544),[[r.Jo,x.searchQuery]]),h])])]),A.filteredDocuments.length>0?((0,o.uX)(),(0,o.CE)("div",f,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(A.paginatedDocuments,(t=>((0,o.uX)(),(0,o.CE)("div",{key:t.documnet_mile_no,class:(0,i.C4)(["mx-auto mb-4 border-bottom p-4 input-base input-white list-wrapper",{activeDelete:x.deleteArray.includes(t)}]),onClick:e=>A.addDeleteDocuArray(t),style:{width:"90%",height:"5em","box-shadow":"0 4px 8px rgba(0, 0, 0, 0.2)","background-color":"#FBFBFB"}},[(0,o.Lk)("div",m,[(0,o.Lk)("button",g,[(0,o.Lk)("div",p,[A.isNew(t.document_date)?((0,o.uX)(),(0,o.CE)("div",y,w)):(0,o.Q3)("",!0),(0,o.Lk)("div",b,[(0,o.Lk)("span",D,(0,i.v_)(t.document_file),1),(0,o.Lk)("span",k,(0,i.v_)(A.formatDate(t.document_date)),1)])])]),(0,o.Lk)("button",{onClick:(0,r.D$)((e=>A.downloadDocu(t.document_file)),["stop"])},C,8,L)])],10,d)))),128))])):((0,o.uX)(),(0,o.CE)("div",M,I)),A.showLoadButton?((0,o.uX)(),(0,o.CE)("div",_,[(0,o.Lk)("button",{onClick:e[2]||(e[2]=(...t)=>A.loadDocuments&&A.loadDocuments(...t)),class:"lg2",style:{"font-family":"'KB_C1'"}},[P,(0,o.eW)(" 더보기 ")])])):(0,o.Q3)("",!0),(0,o.Lk)("div",O,[(0,o.Lk)("div",E,[(0,o.Lk)("div",S,[(0,o.Lk)("button",{onClick:e[3]||(e[3]=(...t)=>A.openModal&&A.openModal(...t)),class:"btn-green",style:{width:"8vw",height:"3vw","font-size":"1.2vw","font-family":"KB_C2"}},"등록하기")]),(0,o.Lk)("div",j,[(0,o.Lk)("button",{onClick:e[4]||(e[4]=(...t)=>A.deleteDocu&&A.deleteDocu(...t)),class:(0,i.C4)(["btn-gray button-style",{choice:x.deleteArray.length>0}]),style:(0,i.Tr)(x.deleteArray.length>0?{"pointer-events":"auto"}:{"pointer-events":"none"})}," 삭제하기 ",6)])])])],4),x.isModalOpen?((0,o.uX)(),(0,o.CE)("div",B,[(0,o.Lk)("div",T,[(0,o.Lk)("span",{class:"close",onClick:e[5]||(e[5]=(...t)=>A.closeModal&&A.closeModal(...t))},"×"),(0,o.Lk)("div",null,[K,(0,o.Lk)("div",F,[(0,o.Lk)("div",Q,[(0,o.Lk)("input",{type:"file",onChange:e[6]||(e[6]=(...t)=>A.onFileChange&&A.onFileChange(...t)),class:"lg2",style:{width:"90%","text-align":"right"}},null,32)])]),(0,o.Lk)("div",X,[(0,o.Lk)("button",{class:"btn-gray mt-2 KB_C2",onClick:e[7]||(e[7]=(...t)=>A.uploadDocument&&A.uploadDocument(...t)),style:{width:"8vw",height:"3vw","font-size":"1.2vw","font-family":"KB_C2"}}," 등록 ")])])],512)])):(0,o.Q3)("",!0)],64)}n(4114);var H=n(6278),N=n(7682),Y=n(5093),$=n.n(Y),V={name:"DocumentsMileageAdminView",data(){return{isModalOpen:!1,file:null,deleteArray:[],baseHeight:90,increment:10,buttonHeight:10,searchQuery:"",currentPage:1,itemsPerPage:7,allDocuments:[],countList:0,lastInputTime:0}},computed:{...(0,H.L8)("mile",["getMileInfo"]),...(0,H.L8)("login",["getLoginInfo"]),...(0,H.L8)("mileExcel",["getArrayMileDocument","getDocumentSum"]),loginInfo(){return this.getLoginInfo},mileInfo(){return this.getMileInfo},arrayMileDocument(){return this.getArrayMileDocument},computedHeight(){let t=this.baseHeight+this.paginatedDocuments.length*this.increment;return this.paginatedDocuments.length%this.itemsPerPage===0&&this.paginatedDocuments.length,t+=this.buttonHeight/2,`${t}vh`},documentSum(){return this.getDocumentSum},filteredDocuments(){return this.allDocuments.filter((t=>t.document_file.includes(this.searchQuery)))},paginatedDocuments(){return this.filteredDocuments.slice(0,this.currentPage*this.itemsPerPage)},showLoadButton(){const t=this.filteredDocuments.length%this.itemsPerPage===0,e=this.filteredDocuments.length>0,n=this.filteredDocuments.length!==this.countList;return t&&e&&n}},methods:{...(0,H.i0)("mile",["fetchMileInfo","getMileDetail"]),...(0,H.i0)("mileExcel",["mileDocumentLists","downloadDocument","deleteMileDocument","getMileDocumentSum"]),openModal(){this.isModalOpen=!0},closeModal(){this.isModalOpen=!1},formatDate(t){return $()(t).format("YYYY-MM-DD")},isNew(t){const e=$()(t),n=$()(),o=$()().subtract(7,"days");return e.isBetween(o,n,null,"[]")},showAlert(t,e,n){this.$swal({title:t,icon:e,scrollbarPadding:!1}).then((t=>{t.isConfirmed&&("#"==n?location.reload():this.$router.push(n))}))},onFileChange(t){this.file=t.target.files[0]},async uploadDocument(){const t=new FormData;t.append("file",this.file),t.append("mile_no",this.loginInfo?this.loginInfo.mile_no:null);try{const e=await N.A.post("/mileage/uploadDocument",t,{headers:{"Content-Type":"multipart/form-data"}});e.data.success?this.showAlert("마일리지 문서 업로드 성공","success","#"):this.showAlert("마일리지 문서 업로드 실패","error","#")}catch(e){console.error("Error uploading document",e),console.log("이건 에러 상태 response status:",e.response.status),e.response&&409===e.response.status?this.showAlert("중복된 파일명이 있습니다","info","#"):this.showAlert("마일리지 문서 업로드 실패","error","#")}},downloadDocu(t){this.downloadDocument({document_file:t})},addDeleteDocuArray(t){this.deleteArray.includes(t)?this.deleteArray=this.deleteArray.filter((e=>e!==t)):(this.deleteArray.push(t),console.log(this.deleteArray))},async deleteDocu(){if(null!=this.deleteArray){const t=await this.deleteMileDocument(this.deleteArray);t&&t.data.success?(console.log("마일리지 문서 파일 삭제 완료"),this.showAlert("마일리지 문서가 삭제되었습니다","success","#"),this.deleteArray=[]):(console.log("마일리지 문서 파일 삭제 실패"),this.showAlert("마일리지 문서 삭제가 실패했습니다","error","#"))}},async loadDocuments(){const t=await this.mileDocumentLists({mile_no:this.loginInfo.mile_no,page:this.currentPage,itemsPerPage:this.itemsPerPage});this.allDocuments.push(...t.data),this.currentPage++;const e=this.loginInfo.mile_no,n=await N.A.get(`/mileage/countListDocuments/${e}`);this.countList=n.data},onSearch(){const t=Date.now(),e=t-this.lastInputTime;e>500&&(this.lastInputTime=t,this.loadDocuments())}},created(){const t=this.loginInfo?this.loginInfo.user_no:null;t?this.mileInfo=this.fetchMileInfo(t):console.error("user_no이 유효하지 않습니다.");const e=this.loginInfo?this.loginInfo.mile_no:null;e?(this.getMileDetail(e),this.loadDocuments(),this.getMileDocumentSum(e)):console.error("mile_no이 유효하지 않습니다.")},watch:{searchQuery(){this.lastInputTime=Date.now(),this.onSearch()}}},W=n(6262);const G=(0,W.A)(V,[["render",z]]);var J=G},9617:function(t,e,n){var o=n(5397),i=n(5610),r=n(6198),s=function(t){return function(e,n,s){var l=o(e),a=r(l);if(0===a)return!t&&-1;var c,u=i(s,a);if(t&&n!==n){while(a>u)if(c=l[u++],c!==c)return!0}else for(;a>u;u++)if((t||u in l)&&l[u]===n)return t||u||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},4527:function(t,e,n){var o=n(3724),i=n(4376),r=TypeError,s=Object.getOwnPropertyDescriptor,l=o&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=l?function(t,e){if(i(t)&&!s(t,"length").writable)throw new r("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},7740:function(t,e,n){var o=n(9297),i=n(5031),r=n(7347),s=n(4913);t.exports=function(t,e,n){for(var l=i(e),a=s.f,c=r.f,u=0;u<l.length;u++){var h=l[u];o(t,h)||n&&o(n,h)||a(t,h,c(e,h))}}},6837:function(t){var e=TypeError,n=9007199254740991;t.exports=function(t){if(t>n)throw e("Maximum allowed index exceeded");return t}},8727:function(t){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},6518:function(t,e,n){var o=n(4475),i=n(7347).f,r=n(6699),s=n(6840),l=n(9433),a=n(7740),c=n(2796);t.exports=function(t,e){var n,u,h,f,d,m,g=t.target,p=t.global,y=t.stat;if(u=p?o:y?o[g]||l(g,{}):o[g]&&o[g].prototype,u)for(h in e){if(d=e[h],t.dontCallGetSet?(m=i(u,h),f=m&&m.value):f=u[h],n=c(p?h:g+(y?".":"#")+h,t.forced),!n&&void 0!==f){if(typeof d==typeof f)continue;a(d,f)}(t.sham||f&&f.sham)&&r(d,"sham",!0),s(u,h,d,t)}}},7055:function(t,e,n){var o=n(9504),i=n(9039),r=n(4576),s=Object,l=o("".split);t.exports=i((function(){return!s("z").propertyIsEnumerable(0)}))?function(t){return"String"===r(t)?l(t,""):s(t)}:s},4376:function(t,e,n){var o=n(4576);t.exports=Array.isArray||function(t){return"Array"===o(t)}},2796:function(t,e,n){var o=n(9039),i=n(4901),r=/#|\.prototype\./,s=function(t,e){var n=a[l(t)];return n===u||n!==c&&(i(e)?o(e):!!e)},l=s.normalize=function(t){return String(t).replace(r,".").toLowerCase()},a=s.data={},c=s.NATIVE="N",u=s.POLYFILL="P";t.exports=s},6198:function(t,e,n){var o=n(8014);t.exports=function(t){return o(t.length)}},741:function(t){var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(t){var o=+t;return(o>0?n:e)(o)}},7347:function(t,e,n){var o=n(3724),i=n(9565),r=n(8773),s=n(6980),l=n(5397),a=n(6969),c=n(9297),u=n(5917),h=Object.getOwnPropertyDescriptor;e.f=o?h:function(t,e){if(t=l(t),e=a(e),u)try{return h(t,e)}catch(n){}if(c(t,e))return s(!i(r.f,t,e),t[e])}},8480:function(t,e,n){var o=n(1828),i=n(8727),r=i.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return o(t,r)}},3717:function(t,e){e.f=Object.getOwnPropertySymbols},1828:function(t,e,n){var o=n(9504),i=n(9297),r=n(5397),s=n(9617).indexOf,l=n(421),a=o([].push);t.exports=function(t,e){var n,o=r(t),c=0,u=[];for(n in o)!i(l,n)&&i(o,n)&&a(u,n);while(e.length>c)i(o,n=e[c++])&&(~s(u,n)||a(u,n));return u}},8773:function(t,e){var n={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,i=o&&!n.call({1:2},1);e.f=i?function(t){var e=o(this,t);return!!e&&e.enumerable}:n},5031:function(t,e,n){var o=n(7751),i=n(9504),r=n(8480),s=n(3717),l=n(8551),a=i([].concat);t.exports=o("Reflect","ownKeys")||function(t){var e=r.f(l(t)),n=s.f;return n?a(e,n(t)):e}},5610:function(t,e,n){var o=n(1291),i=Math.max,r=Math.min;t.exports=function(t,e){var n=o(t);return n<0?i(n+e,0):r(n,e)}},5397:function(t,e,n){var o=n(7055),i=n(7750);t.exports=function(t){return o(i(t))}},1291:function(t,e,n){var o=n(741);t.exports=function(t){var e=+t;return e!==e||0===e?0:o(e)}},8014:function(t,e,n){var o=n(1291),i=Math.min;t.exports=function(t){var e=o(t);return e>0?i(e,9007199254740991):0}},4114:function(t,e,n){var o=n(6518),i=n(8981),r=n(6198),s=n(4527),l=n(6837),a=n(9039),c=a((function(){return 4294967297!==[].push.call({length:4294967296},1)})),u=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},h=c||!u();o({target:"Array",proto:!0,arity:1,forced:h},{push:function(t){var e=i(this),n=r(e),o=arguments.length;l(n+o);for(var a=0;a<o;a++)e[n]=arguments[a],n++;return s(e,n),n}})}}]);
//# sourceMappingURL=8848.419778ce.js.map