"use strict";(self["webpackChunkmile"]=self["webpackChunkmile"]||[]).push([[803],{80803:function(t,e,i){i.r(e),i.d(e,{default:function(){return wt}});var o=i(20641),n=i(90033),s=i(53751);const a=t=>((0,o.Qi)("data-v-c2b7713a"),t=t(),(0,o.jt)(),t),l={class:"app-container"},r={key:0,class:"content cards"},c={class:"header"},d={class:"back-container"},m=a((()=>(0,o.Lk)("span",{class:"arrow"},"❮",-1))),p={class:"actions"},u={key:0},h={key:1},_={class:"content"},f={key:0,class:"new-label"},g={class:"title"},k={class:"meta"},C={class:"author"},y={class:"date"},b={class:"main-content"},L={class:"body"},w={class:"file cards"},v={style:{display:"flex","align-items":"center"}},B=a((()=>(0,o.Lk)("h2",{style:{"margin-right":"10px"}},"첨부파일",-1))),x={key:0,style:{color:"#4b4a4a","font-family":"'KB_C2', sans-serif","margin-left":"2%","white-space":"nowrap"}},E={key:0,style:{"margin-top":"10px"}},I={class:"stats-container"},T={class:"icon-container"},N=a((()=>(0,o.Lk)("div",{class:"views-icon"},[(0,o.Lk)("i",{class:"bi bi-eye"})],-1))),$={class:"views-text"},X={class:"heart-icon"},D={class:"views-text"},A={class:"content-container mx-auto"},S={class:"actions"},R={key:0},K={key:1},M=a((()=>(0,o.Lk)("span",{class:"alert-icon"},"🚨",-1))),P=a((()=>(0,o.Lk)("hr",{class:"divider"},null,-1))),U={key:1},O={key:0},V={key:1};function z(t,e,i,a,z,Q){const j=(0,o.g2)("UserComment");return(0,o.uX)(),(0,o.CE)("div",l,[Q.notice?((0,o.uX)(),(0,o.CE)("div",r,[(0,o.Lk)("div",c,[(0,o.Lk)("div",d,[(0,o.Lk)("button",{class:"back-button",onClick:e[0]||(e[0]=(...t)=>Q.goBack&&Q.goBack(...t))},[m,(0,o.eW)(" 이전 ")])]),(0,o.Lk)("div",p,[Q.isLoggedIn&&Q.notice.user_no===Q.loginInfo.user_no&&!Q.isChecked?((0,o.uX)(),(0,o.CE)("div",u,[(0,o.Lk)("button",{class:"edit-button mr-3",onClick:e[1]||(e[1]=(...t)=>Q.goToModifyView&&Q.goToModifyView(...t))}," 수정 "),(0,o.Lk)("button",{class:"delete-button mr-3",onClick:e[2]||(e[2]=(...t)=>Q.deleteNotice&&Q.deleteNotice(...t))}," 삭제 ")])):(0,o.Q3)("",!0),Q.isLoggedIn&&Q.loginInfo.user_is_admin&&!Q.loginInfo.user_is_manager&&Q.isChecked?((0,o.uX)(),(0,o.CE)("div",h,[(0,o.Lk)("button",{class:"revoke-button",onClick:e[3]||(e[3]=(...t)=>Q.mtip_complainBack&&Q.mtip_complainBack(...t))}," 신고취하 "),(0,o.eW)("    "),(0,o.Lk)("button",{class:"delete-button",onClick:e[4]||(e[4]=(...t)=>Q.deleteNoticeAdmin&&Q.deleteNoticeAdmin(...t))}," 삭제 ")])):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",_,[Q.isNew(Q.notice?.mtip_board_date)?((0,o.uX)(),(0,o.CE)("span",f,"NEW")):(0,o.Q3)("",!0),(0,o.Lk)("h1",g,(0,n.v_)(Q.notice?.mtip_board_title),1),(0,o.Lk)("div",k,[(0,o.Lk)("span",C,(0,n.v_)(Q.notice?.user_name),1),(0,o.Lk)("span",y,(0,n.v_)(Q.formatDate(Q.notice?.mtip_board_date)),1)]),(0,o.Lk)("div",b,[(0,o.Lk)("div",L,[(0,o.Lk)("pre",null,[(0,o.Lk)("p",null,(0,n.v_)(Q.notice?.mtip_board_content),1)])]),(0,o.Lk)("div",w,[(0,o.Lk)("div",v,[B,Q.notice.mtip_board_file?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",x,"파일이 존재하지 않습니다."))]),Q.notice.mtip_board_file?((0,o.uX)(),(0,o.CE)("div",E,[(0,o.Lk)("a",{onClick:e[5]||(e[5]=(0,s.D$)(((...t)=>Q.downloadFile&&Q.downloadFile(...t)),["prevent"])),href:"#",class:"file-download-link"},(0,n.v_)(Q.getDisplayFileName(Q.notice?.mtip_board_file)),1)])):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",I,[(0,o.Lk)("div",T,[N,(0,o.Lk)("div",$,(0,n.v_)(Q.notice?.mtip_board_hit),1)]),(0,o.Lk)("div",{class:"icon-container",onClick:e[6]||(e[6]=(...t)=>Q.toggleLike&&Q.toggleLike(...t))},[(0,o.Lk)("div",X,[(0,o.Lk)("i",{class:(0,n.C4)(["bi",Q.isLiked?"bi-heart-fill":"bi-heart"]),style:(0,n.Tr)({color:Q.isLiked?"#dc3545":"inherit"})},null,6)]),(0,o.Lk)("div",D,(0,n.v_)(Q.notice?.mtip_board_like),1)])])]),(0,o.Lk)("div",A,[(0,o.Lk)("div",S,[Q.isLoggedIn&&Q.loginInfo.user_is_admin&&Q.isChecked?((0,o.uX)(),(0,o.CE)("div",R)):((0,o.uX)(),(0,o.CE)("div",K,[M,(0,o.Lk)("button",{class:"report-button",onClick:e[7]||(e[7]=(...t)=>Q.mtip_complain&&Q.mtip_complain(...t))}," 신고하기 ")]))]),P,z.isNoticeLoaded?((0,o.uX)(),(0,o.Wv)(j,{key:0,"login-info":Q.loginInfo,mtip_board_no:Q.notice.mtip_board_no},null,8,["login-info","mtip_board_no"])):(0,o.Q3)("",!0)])])):((0,o.uX)(),(0,o.CE)("div",U,[z.isLoading?((0,o.uX)(),(0,o.CE)("p",O,"Loading...")):((0,o.uX)(),(0,o.CE)("p",V,"No data available"))]))])}i(44114),i(14603),i(47566),i(98721);var Q=i(37682),j=i(66278),F=i(78465),W=i.n(F);const J=t=>((0,o.Qi)("data-v-c0842bc2"),t=t(),(0,o.jt)(),t),q={class:"comments-section"},G={class:"comments-header"},H=J((()=>(0,o.Lk)("i",{class:"bi bi-chat-right-text",style:{"font-size":"20px","margin-right":"10px"}},null,-1))),Y={style:{"font-size":"17px","font-family":"'KB_C2', sans-serif","text-align":"left",margin:"0"}},Z={class:"comment-input",style:{width:"100%"}},tt={key:0},et=["src"],it={class:"comment-content"},ot={class:"comment-meta"},nt={class:"comment-user",style:{"font-family":"'KB_C2', sans-serif","font-size":"18px","margin-right":"15px"}},st={class:"comment-date",style:{"font-family":"'KB_C2', sans-serif","font-size":"14px"}},at={class:"comment-actions",style:{"margin-left":"50px"}},lt={key:0},rt=["onClick"],ct=["onClick"],dt=["onClick"],mt={key:0},pt=["onUpdate:modelValue"],ut={key:1,class:"comment-text",style:{"font-family":"'KB_C2', sans-serif","font-size":"18px","margin-right":"1%","text-align":"left"}},ht={key:1,style:{"font-family":"'KB_C2', sans-serif","font-size":"15px","margin-top":"100px"}};function _t(t,e,i,a,l,r){return(0,o.uX)(),(0,o.CE)("div",q,[(0,o.Lk)("div",G,[H,(0,o.Lk)("h3",Y," 댓글 ("+(0,n.v_)(r.comments.length)+") ",1)]),(0,o.Lk)("div",Z,[(0,o.bo)((0,o.Lk)("textarea",{class:"input-base",placeholder:"댓글을 입력해주세요","onUpdate:modelValue":e[0]||(e[0]=t=>l.newComment=t),onKeydown:e[1]||(e[1]=(0,s.jR)((0,s.D$)(((...t)=>r.addComment&&r.addComment(...t)),["prevent"]),["enter"])),style:{"font-family":"'KB_C2', sans-serif","font-size":"18px",width:"100%",height:"80px",resize:"none",padding:"10px","text-align":"left"}},null,544),[[s.Jo,l.newComment]]),(0,o.Lk)("button",{class:"btn-yellow btn-yellow:hover",onClick:e[2]||(e[2]=(...t)=>r.addComment&&r.addComment(...t)),onKeydown:e[3]||(e[3]=(0,s.jR)((0,s.D$)(((...t)=>r.addComment&&r.addComment(...t)),["prevent"]),["enter"])),style:{"font-family":"'KB_C2', sans-serif","font-size":"18px",width:"100px",height:"80px",color:"#4b4a4a"}}," 등록 ",32)]),r.comments&&r.comments.length?((0,o.uX)(),(0,o.CE)("div",tt,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.comments,(t=>((0,o.uX)(),(0,o.CE)("div",{class:"comment",key:t.mtip_reply_no},[t&&t.user_no?((0,o.uX)(),(0,o.CE)("img",{key:0,src:r.profileImageUrl(t.user_no),class:"profile-small my-3",alt:"Profile Picture",onError:e[4]||(e[4]=(...t)=>r.setDefaultImage&&r.setDefaultImage(...t))},null,40,et)):(0,o.Q3)("",!0),(0,o.Lk)("div",it,[(0,o.Lk)("div",ot,[(0,o.Lk)("span",nt,(0,n.v_)(t.user_name),1),(0,o.Lk)("span",st,(0,n.v_)(r.formatDate(t.mtip_reply_date)),1),(0,o.Lk)("div",at,[t.user_no===i.loginInfo.user_no?((0,o.uX)(),(0,o.CE)("div",lt,[t.isEditing?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("button",{key:0,class:"edit-button",onClick:e=>r.startEditing(t),style:{color:"#714319"}}," 수정 ",8,rt)),t.isEditing?((0,o.uX)(),(0,o.CE)("button",{key:1,class:"edit-button",onClick:e=>r.finishEditing(t),style:{color:"#714319"}}," 수정완료 ",8,ct)):(0,o.Q3)("",!0),(0,o.eW)("   "),(0,o.Lk)("button",{class:"delete-button",onClick:e=>r.deleteComment(t.mtip_reply_no),style:{color:"red"}}," 삭제 ",8,dt)])):(0,o.Q3)("",!0)])]),t.isEditing?((0,o.uX)(),(0,o.CE)("div",mt,[(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":e=>t.editingContent=e,class:"input-base",style:{"font-family":"'KB_C2', sans-serif","min-height":"30px",height:"auto","font-size":"18px",width:"100%",resize:"none","overflow-y":"hidden","line-height":"2","text-align":"left","box-sizing":"border-box"}},null,8,pt),[[s.Jo,t.editingContent]])])):((0,o.uX)(),(0,o.CE)("div",ut,(0,n.v_)(t.mtip_reply_content||t.editingContent),1))])])))),128))])):((0,o.uX)(),(0,o.CE)("div",ht," 해당 게시글의 댓글이 없습니다. "))])}var ft={name:"UserComment",props:{loginInfo:{type:Object,required:!0},mtip_board_no:{type:Number,required:!0}},data(){return{newComment:""}},created(){this.fetchComments(this.mtip_board_no)},computed:{...(0,j.L8)("mtipReply",["getComments"]),comments(){return this.getComments}},watch:{comments:{deep:!0}},methods:{...(0,j.i0)("mtipReply",["fetchComments","addComment","updateComment","deleteComment"]),profileImageUrl(t){return null!=t?`/profile/${t}.jpg`:""},getInitials(t){return t?t.charAt(0).toUpperCase():"?"},startEditing(t){t.isEditing=!0,t.editingContent=t.mtip_reply_content},async fetchComments(t){await this.$store.dispatch("mtipReply/fetchComments",t)},async addComment(){if(!this.newComment.trim())return;const t={user_no:this.loginInfo.user_no,user_name:this.loginInfo.user_name,mtip_board_no:this.mtip_board_no,mtip_reply_content:this.newComment.trim()};try{await this.$store.dispatch("mtipReply/addComment",t),this.newComment="",await this.fetchComments(this.mtip_board_no)}catch(e){console.error("댓글 등록 중 오류가 발생했습니다:",e)}},setDefaultImage(t){t.target.src=i(16468)},formatDate(t){const e={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(t).toLocaleString("ko-KR",e)},goToModifyView(t){this.newComment=t.mtip_reply_content,this.editingCommentId=t.mtip_reply_no},async finishEditing(t){if(!t.editingContent.trim())return;const e={mtip_reply_no:t.mtip_reply_no,mtip_reply_content:t.editingContent.trim()};try{const i=await this.$store.dispatch("mtipReply/updateComment",e);t.mtip_reply_content=i.mtip_reply_content||t.editingContent.trim(),t.isEditing=!1}catch(i){console.error("댓글 수정 중 오류가 발생했습니다:",i)}},async deleteComment(t){try{await this.$store.dispatch("mtipReply/deleteComment",t)}catch(e){console.error("댓글 삭제 중 오류가 발생했습니다:",e)}}}},gt=i(66262);const kt=(0,gt.A)(ft,[["render",_t],["__scopeId","data-v-c0842bc2"]]);var Ct=kt,yt=i(4034),bt={name:"M_TipDetailView",props:["mtip_board_no"],modules:{mtipReply:yt.A},data(){return{isLoading:!0,isNoticeLoaded:!1,comments:[],localIsLiked:!1}},watch:{"$route.params.mtip_board_no":{immediate:!0,handler(t,e){t&&t!==e&&(this.fetchNoticeDetail(t),this.$store.commit("mtipReply/CLEAR_COMMENTS"),this.$store.dispatch("mtipReply/fetchComments",t))}}},components:{UserComment:Ct},methods:{...(0,j.i0)("mtipBoard",["fetchNoticeDetail","likePost","unlikePost","checkLikeStatus"]),...(0,j.PY)("mtipBoard",["SET_LIKE_STATUS"]),async toggleLike(){if(console.log("여기까지오긴옴"),this.loginInfo)if(console.log("로그인확인완룡"),this.notice){console.log("노티스확인완룡!");try{const t=this.isLiked?"unlikePost":"likePost";console.log("이제 엑시오스 갈거임.");const e=await this.$store.dispatch(`mtipBoard/${t}`,{mtip_board_no:this.notice.mtip_board_no,user_no:this.loginInfo.user_no});console.log("서버에서 받은 좋아요 상태:",e),await this.updateLikeStatus(this.notice.mtip_board_no),-1!==e&&(this.notice.mtip_board_like=e.isLiked)}catch(t){console.error("Error toggling like:",t)}}else console.error("Notice data is not available");else alert("로그인이 필요합니다.")},async deleteNotice(){W().fire({title:"경고",text:"정말로 삭제하시겠습니까?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#4b4a4a",cancelButtonColor:"#bd2c3a",confirmButtonText:"확인",cancelButtonText:"취소",reverseButtons:!1,allowOutsideClick:!1,scrollbarPadding:!1}).then((async t=>{if(t.isConfirmed)try{await Q.A.delete(`/mtip/delete/${this.notice.mtip_board_no}`),W().fire({title:"게시글 삭제 완료",text:"게시글이 삭제 되었습니다.",icon:"success",allowOutsideClick:!1,scrollbarPadding:!1}).then((()=>{this.$router.push("/M_TipListView")}))}catch(e){console.error("게시글 삭제 중 오류가 발생했습니다.",e),W().fire({title:"게시글 삭제 중 오류가 발생했습니다.",icon:"error",allowOutsideClick:!1,scrollbarPadding:!1})}}))},async deleteNoticeAdmin(){W().fire({title:"경고",text:"정말로 삭제하시겠습니까?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#4b4a4a",cancelButtonColor:"#bd2c3a",confirmButtonText:"확인",cancelButtonText:"취소",reverseButtons:!1,allowOutsideClick:!1,scrollbarPadding:!1}).then((async t=>{if(t.isConfirmed)try{await Q.A.delete(`/mtip/delete/${this.notice.mtip_board_no}`),W().fire({title:"게시글 삭제 완료",text:"게시글이 삭제 되었습니다.",icon:"success",allowOutsideClick:!1,scrollbarPadding:!1}).then((()=>{this.$router.push("/mTipMainAdminView")}))}catch(e){console.error("게시글 삭제 중 오류가 발생했습니다.",e),W().fire({title:"게시글 삭제 중 오류가 발생했습니다.",icon:"error",allowOutsideClick:!1,scrollbarPadding:!1})}}))},mtip_complain(){1!==this.notice.mtip_complain&&!0!==this.notice.mtip_complain?W().fire({title:"신고",text:"정말로 이 게시글을 신고하시겠습니까?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#4b4a4a",cancelButtonColor:"#bd2c3a",confirmButtonText:"확인",cancelButtonText:"취소",reverseButtons:!1}).then((async t=>{if(t.isConfirmed)try{await Q.A.post(`/mtip/complain/${this.notice.mtip_board_no}`),W().fire("신고완료","정상적으로 게시글 신고가 완료되었습니다.","success").then((()=>{this.$router.push("/M_TipListView")}))}catch(e){console.error("신고하기 중 오류가 발생했습니다.",e),W().fire("신고하기 중 오류가 발생했습니다.","","error")}})):W().fire({title:"경고",text:"이미 신고된 게시글 입니다.",icon:"error",showCancelButton:!0,confirmButtonColor:"#4b4a4a",cancelButtonColor:"#bd2c3a",confirmButtonText:"확인",cancelButtonText:"취소",reverseButtons:!1})},mtip_complainBack(){W().fire({title:"신고취하",text:"정말로 이 게시글을 신고취하 하시겠습니까?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#4b4a4a",cancelButtonColor:"#bd2c3a",confirmButtonText:"확인",cancelButtonText:"취소",reverseButtons:!1}).then((async t=>{if(t.isConfirmed)try{await Q.A.post(`/mtip/complainBack/${this.notice.mtip_board_no}`),W().fire("성공","정상적으로 게시글 신고취하가 완료되었습니다.","success").then((()=>{this.$router.push("/mTipMainAdminView")}))}catch(e){console.error("신고취하 중 오류가 발생했습니다.",e),W().fire("신고취하 중 오류가 발생했습니다.","","error")}}))},showAlert(t,e){this.$swal({title:t,icon:e,confirmButtonText:"확인",confirmButtonColor:"#4b4a4a",allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,stopKeydownPropagation:!1,scrollbarPadding:!1,backdrop:!0,didOpen:()=>{document.body.classList.add("no-scroll"),document.documentElement.style.overflow="hidden"},willClose:()=>{document.body.classList.remove("no-scroll"),document.documentElement.style.overflow=""}})},getDisplayFileName(t){const e=37;return!t||t.length<=e?t:"_"===t.charAt(e-1)?t.substring(e):t},goBack(){this.$router.go(-1)},goToModifyView(){console.log("modify 화면으로 넘긴 정보:",this.notice.mtip_board_no),this.$router.push({name:"m_TipModifyView",params:{mtip_board_no:this.notice.mtip_board_no}})},isNew(t){const e=new Date,i=new Date(t),o=Math.abs(e-i),n=Math.ceil(o/864e5);return n<=7},formatDate(t){if(!t)return"Date not available";const e=new Date(t);if(isNaN(e.getTime()))return console.error("Invalid date string:",t)," ↺ 댓글 등록 중";const i={year:"numeric",month:"2-digit",day:"2-digit"};return e.toLocaleString("ko-KR",i)},async downloadFile(){try{const t=encodeURIComponent(this.notice.mtip_board_file),e=await(0,Q.A)({url:`/mtip/downloadGuide/${t}`,method:"GET",responseType:"blob"}),i=window.URL.createObjectURL(new Blob([e.data])),o=document.createElement("a");o.href=i,o.setAttribute("download",this.notice.mtip_board_file),document.body.appendChild(o),o.click(),document.body.removeChild(o)}catch(t){console.error("파일 다운로드 중 오류 발생:",t),this.showAlert("파일 다운로드 중 오류가 발생했습니다.","error")}},async fetchNoticeDetail(t){this.isLoading=!0,this.isNoticeLoaded=!1;try{await this.$store.dispatch("mtipBoard/fetchNoticeDetail",t),await this.updateLikeStatus(t),this.isLoading=!1,this.isNoticeLoaded=!0}catch(e){console.error("Error fetching notice detail:",e),this.isLoading=!1}},async updateLikeStatus(t){if(this.loginInfo&&this.loginInfo.user_no){const e=await this.checkLikeStatus({mtip_board_no:t,user_no:this.loginInfo.user_no});this.localIsLiked=e,this.SET_LIKE_STATUS({user_no:this.loginInfo.user_no,mtip_board_no:t,isLiked:e}),localStorage.setItem(`likeStatus_${t}`,JSON.stringify(e)),console.log("Updated like status:",e)}}},computed:{...(0,j.L8)("login",["getLoginInfo","getIsChecked"]),...(0,j.L8)("mtipBoard",["getNotice"]),...(0,j.aH)("login",["loginInfo"]),...(0,j.aH)("mtipBoard",["likedPosts"]),notice(){return this.getNotice||null},loginInfo(){return this.getLoginInfo},isChecked(){return this.getIsChecked},isLoggedIn(){return!!this.loginInfo},mileNo(){return this.$route.params.notice.mtip_board_no},isLiked(){return this.localIsLiked}},async mounted(){const t=this.$route.params.mtip_board_no;if(t){await this.fetchNoticeDetail(t),this.$store.commit("mtipReply/CLEAR_COMMENTS"),await this.$store.dispatch("mtipReply/fetchComments",t);const e=localStorage.getItem(`likeStatus_${t}`);null!==e&&(this.localIsLiked=JSON.parse(e),console.log("Loaded like status from localStorage:",this.localIsLiked))}}};const Lt=(0,gt.A)(bt,[["render",z],["__scopeId","data-v-c2b7713a"]]);var wt=Lt}}]);
//# sourceMappingURL=803.a27da3d0.js.map