"use strict";(self["webpackChunkmile"]=self["webpackChunkmile"]||[]).push([[9279],{9279:function(t,e,s){s.r(e),s.d(e,{default:function(){return W}});var a=s(641),i=s(33);const n=t=>((0,a.Qi)("data-v-627fcf8d"),t=t(),(0,a.jt)(),t),l={class:"button-container mt-3"},o=n((()=>(0,a.Lk)("span",{class:"arrow"},"❮",-1))),c=n((()=>(0,a.Lk)("h2",{class:"bold-x-lg my-5",style:{"font-family":"KB_C3"}},"채택하기",-1))),r={style:{padding:"0 5%"}},d={class:"p-4 mt-5"},g={class:"d-flex justify-content-between align-items-center"},h={class:"lg p-3",style:{"text-align":"left","font-family":"KB_C2"}},u={style:{"font-size":"10pt"}},k={class:"p-2",style:{"justify-content":"space-between","align-items":"flex-start","background-color":"#f6f6f6"}},p={style:{display:"flex","justify-content":"space-between"}},m={class:"king",style:{width:"48%"}},f=n((()=>(0,a.Lk)("div",{class:"KB_C1 title",style:{"font-size":"20pt","margin-top":"30px"}}," 마왕 TOP 5 ",-1))),L=n((()=>(0,a.Lk)("br",null,null,-1))),y={class:"text-center mx-auto",style:{width:"80%"}},v={class:"KB_S1 text-center"},w={class:"item-rank"},b={class:"item-name"},D={class:"item-score"},_={class:"jump",style:{width:"48%"}},x=n((()=>(0,a.Lk)("div",{class:"KB_C1 title",style:{"font-size":"20pt","margin-top":"30px"}}," Jump UP TOP 5 ",-1))),C=n((()=>(0,a.Lk)("br",null,null,-1))),j={class:"text-center mx-auto",style:{width:"80%"}},B={class:"KB_S1 text-center"},M={class:"item-rank"},T={class:"item-name"},U={class:"item-score"},E={style:{padding:"0 5%"}},K={class:"p-4 mt-5"},F=n((()=>(0,a.Lk)("div",{class:"d-flex justify-content-between align-items-center"},[(0,a.Lk)("h3",{class:"lg p-3",style:{"text-align":"left","font-family":"KB_C2"}}," 문서 업데이트 현황 ")],-1))),I={class:"p-2",style:{"justify-content":"space-between","align-items":"flex-start"}},A={class:"styled-table"},P=n((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"마일리지"),(0,a.Lk)("th",null,"최종 업데이트")])],-1))),S={class:"btn-container",style:{"margin-right":"75px"}};function O(t,e,s,n,O,X){return(0,a.uX)(),(0,a.CE)("div",{class:"cards page-back mx-auto",style:(0,i.Tr)({height:t.computedHeight})},[(0,a.Lk)("div",l,[(0,a.Lk)("button",{class:"back-button",onClick:e[0]||(e[0]=(...t)=>X.goBack&&X.goBack(...t))},[o,(0,a.eW)(" 이전 ")])]),c,(0,a.Lk)("div",r,[(0,a.Lk)("div",d,[(0,a.Lk)("div",g,[(0,a.Lk)("h3",h,[(0,a.eW)(" TOP 상위 리스트 "),(0,a.Lk)("span",u," (최근 업데이트 : "+(0,i.v_)(O.baseDate)+") ",1)])]),(0,a.Lk)("div",k,[(0,a.Lk)("div",p,[(0,a.Lk)("div",m,[f,L,(0,a.Lk)("div",y,[(0,a.Lk)("div",v,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(O.kingTop5,((t,e)=>((0,a.uX)(),(0,a.CE)("div",{key:e,class:(0,i.C4)([{top1:0===e},"top-item"])},[(0,a.Lk)("div",w,(0,i.v_)(t.ranking)+"등",1),(0,a.Lk)("div",b,(0,i.v_)(t.user_name),1),(0,a.Lk)("div",D,(0,i.v_)(t.total_score),1)],2)))),128))])])]),(0,a.Lk)("div",_,[x,C,(0,a.Lk)("div",j,[(0,a.Lk)("div",B,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(O.jumpTop5,((t,e)=>((0,a.uX)(),(0,a.CE)("div",{key:e,class:(0,i.C4)([{top1:0===e},"top-item"])},[(0,a.Lk)("div",M,(0,i.v_)(t.ranking)+"등",1),(0,a.Lk)("div",T,(0,i.v_)(t.user_name),1),(0,a.Lk)("div",U,(0,i.v_)(t.score_increase),1)],2)))),128))])])])])])])]),(0,a.Lk)("div",E,[(0,a.Lk)("div",K,[F,(0,a.Lk)("div",I,[(0,a.Lk)("table",A,[P,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(O.mileageLabels,((t,e)=>((0,a.uX)(),(0,a.CE)("tr",{key:e},[(0,a.Lk)("td",null,(0,i.v_)(t),1),(0,a.Lk)("td",null,(0,i.v_)(O.dates[e]||"-"),1)])))),128))])])])])]),(0,a.Lk)("div",S,[(0,a.Lk)("button",{class:"btn-yellow KB_S4",onClick:e[1]||(e[1]=(...t)=>X.checkValidDates&&X.checkValidDates(...t))}," 채택하기 ")])],4)}s(4114),s(4603),s(7566),s(8721);var X=s(7682),Y=s(8465),$=s.n(Y),V=s(6278),z={name:"KingPickView",data(){return{kingTop5:[],jumpTop5:[],baseDate:"",mileageLabels:[],dates:[],kingUserList:[],jumpUserList:[]}},async mounted(){await this.kingData(),await this.jumpData(),await this.fetchMileageLabels(),await this.lastUpdate()},methods:{checkLoginInfo(){this.getLoginInfo&&!1!==this.getIsChecked&&!1!==this.getLoginInfo.user_is_admin||(window.location.href="/noAccess")},async kingData(){try{const t=await X.A.get("/mileage/kingDataSelect");console.log("kingDataSelect top5:",t.data),this.baseDate=t.data.length?t.data[0].base_date:"",this.kingTop5=t.data.slice(0,5);const e=t.data.sort(((t,e)=>e.score-t.score));let s=1,a=e[0].score;const i=[];for(const n of e){if(n.score!==a&&(s++,a=n.score),s>3)break;i.push(n.user_no)}this.kingUserList=i}catch(t){console.error("kingDataSelect top5:",t),this.kingTop5=[],this.kingUserList=[]}},async jumpData(){try{const t=await X.A.get("/mileage/jumpDataSelect");console.log("점프업 top5:",t.data),this.jumpTop5=t.data.slice(0,5);const e=t.data.sort(((t,e)=>e.score-t.score));let s=1,a=e[0].score;const i=[];for(const n of e){if(n.score!==a&&(s++,a=n.score),s>3)break;i.push(n.user_no)}this.jumpUserList=i}catch(t){console.error("점프업 top5:",t),this.jumpTop5=[],this.jumpUserList=[]}},async fetchMileageLabels(){try{const t=await X.A.get("/mileage/getMileage");this.mileageLabels=t.data.map((t=>t.mile_name)),this.dates=new Array(this.mileageLabels.length).fill("-")}catch(t){console.error("Error fetching mileage labels:",t),this.mileageLabels=[],this.dates=[]}},async lastUpdate(){try{const t=await X.A.get("/admin/lastUpdate");console.log("날짜 데이터",t.data),this.dates=t.data.map((t=>t.date||"-"))}catch(t){console.error("Error fetching last update dates:",t),this.dates=new Array(this.mileageLabels.length).fill("-")}},isLastDayOfPreviousMonth(t){if(!t||"-"===t)return!1;const e=new Date(t),s=new Date,a=new Date(s.getFullYear(),s.getMonth(),1),i=new Date(a-1);return e.getFullYear()===i.getFullYear()&&e.getMonth()===i.getMonth()&&e.getDate()===i.getDate()},checkValidDates(){if(this.isFirstBusinessDayOfCurrentMonth)return void $().fire("오류","해당일은 채택일이 아닙니다.","error");const t=this.dates.map(((t,e)=>({date:t,index:e}))).filter((({date:t})=>"-"===t||!this.isLastDayOfPreviousMonth(t)));if(t.length>0){const e=t.map((({index:t})=>`${this.mileageLabels[t]} (${"-"===this.dates[t]?"날짜 없음":this.dates[t]})`)).join("<br>");$().fire({icon:"warning",title:"업데이트 날짜 오류",html:`\n    <div id="swal-content">\n      <div>최종 업데이트 날짜가 말일이 아닌 것이 있습니다.</div>\n      <div class="swal-dates-list" style="color: red;">${e}</div>\n    </div>\n  `,confirmButtonText:"확인",heightAuto:!1,scrollbarPadding:!1,customClass:{container:"my-swal-container",content:"my-swal-content",popup:"swal2-popup"},width:"auto",didOpen:t=>{const e=t.querySelector("#swal-content"),s=.7*window.innerHeight;e.offsetHeight>s?(e.style.height=`${s}px`,e.style.overflowY="auto"):t.style.height="auto"}})}else this.pickBadge()},isFirstBusinessDayOfCurrentMonth(){const t=new Date,e=t.getFullYear(),s=t.getMonth(),a=new Date(e,s,1);let i=a;while(0===i.getDay()||6===i.getDay())i.setDate(i.getDate()+1);return t.getFullYear()===i.getFullYear()&&t.getMonth()===i.getMonth()&&t.getDate()===i.getDate()},async pickBadge(){try{const t=new URLSearchParams;this.kingUserList.forEach((e=>t.append("king",e))),this.jumpUserList.forEach((e=>t.append("jump",e)));const e=await X.A.post(`/admin/pickBadge?${t.toString()}`);console.log("Response:",e.data),$().fire({icon:"success",title:"채택완료",text:"성공적으로 완료되었습니다",scrollbarPadding:!1})}catch(t){console.error("Error picking badge:",t)}},goBack(){this.$router.go(-1)}},created(){this.checkLoginInfo()},computed:{...(0,V.L8)("login",["getLoginInfo","getIsChecked"])}},H=s(6262);const R=(0,H.A)(z,[["render",O],["__scopeId","data-v-627fcf8d"]]);var W=R}}]);
//# sourceMappingURL=9279.b97ce353.js.map